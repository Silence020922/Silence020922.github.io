<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>CUDA编程 | Silence's blog</title>
    <meta name="description" content="无...">
    <meta name="generator" content="VitePress v1.0.0-rc.31">
    <link rel="preload stylesheet" href="/assets/style.jx_1Qzz9.css" as="style">
    
    <script type="module" src="/assets/app.aDMMcYXa.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.bvIUbFQP.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/assets/chunks/framework.CP3Xps-Z.js">
    <link rel="modulepreload" href="/assets/chunks/theme.FIb7foNI.js">
    <link rel="modulepreload" href="/assets/chunks/Page.qgDUVnsQ.js">
    <link rel="modulepreload" href="/assets/posts_CUDA.md.Dith_Bog.lean.js">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"dark",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><!--[--><div class="Layout" data-v-9d8abc1e><!--[--><!--]--><!--[--><span tabindex="-1" data-v-c8291ffa></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-c8291ffa> Skip to content </a><!--]--><!----><header class="VPNav" data-v-9d8abc1e data-v-7ad780c2><div class="VPNavBar" data-v-7ad780c2 data-v-5befd255><div class="container" data-v-5befd255><div class="title" data-v-5befd255><div class="VPNavBarTitle" data-v-5befd255 data-v-2973dbb4><a class="title" href="/" data-v-2973dbb4><!--[--><!--]--><!----><!--[-->Silence&#39;s blog<!--]--><!--[--><!--]--></a></div></div><div class="content" data-v-5befd255><div class="curtain" data-v-5befd255></div><div class="content-body" data-v-5befd255><!--[--><!--]--><div class="VPNavBarSearch search" data-v-5befd255><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg class="DocSearch-Search-Icon" width="20" height="20" viewBox="0 0 20 20" aria-label="search icon"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-5befd255 data-v-f732b5d0><span id="main-nav-aria-label" class="visually-hidden" data-v-f732b5d0>Main Navigation</span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/" tabindex="0" data-v-f732b5d0 data-v-cb318fec><!--[--><span data-v-cb318fec>Home</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/pages/archives.html" tabindex="0" data-v-f732b5d0 data-v-cb318fec><!--[--><span data-v-cb318fec>Archives</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/pages/tags.html" tabindex="0" data-v-f732b5d0 data-v-cb318fec><!--[--><span data-v-cb318fec>Tags</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/pages/about.html" tabindex="0" data-v-f732b5d0 data-v-cb318fec><!--[--><span data-v-cb318fec>About</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-5befd255 data-v-283b26e9><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="Switch to light theme" aria-checked="true" data-v-283b26e9 data-v-70af5d02 data-v-1c29e291><span class="check" data-v-1c29e291><span class="icon" data-v-1c29e291><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-70af5d02><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-70af5d02><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div><!----><div class="VPFlyout VPNavBarExtra extra" data-v-5befd255 data-v-8e87c032 data-v-aa8de344><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-aa8de344><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-aa8de344><circle cx="12" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle><circle cx="5" cy="12" r="2"></circle></svg></button><div class="menu" data-v-aa8de344><div class="VPMenu" data-v-aa8de344 data-v-e42ed9b3><!----><!--[--><!--[--><!----><div class="group" data-v-8e87c032><div class="item appearance" data-v-8e87c032><p class="label" data-v-8e87c032>Appearance</p><div class="appearance-action" data-v-8e87c032><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="Switch to light theme" aria-checked="true" data-v-8e87c032 data-v-70af5d02 data-v-1c29e291><span class="check" data-v-1c29e291><span class="icon" data-v-1c29e291><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-70af5d02><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-70af5d02><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div></div></div><!----><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-5befd255 data-v-6bee1efd><span class="container" data-v-6bee1efd><span class="top" data-v-6bee1efd></span><span class="middle" data-v-6bee1efd></span><span class="bottom" data-v-6bee1efd></span></span></button></div></div></div></div><!----></header><div class="VPLocalNav fixed reached-top" data-v-9d8abc1e data-v-f8a0b38a><!----><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-f8a0b38a data-v-24251f6f><button data-v-24251f6f>Return to top</button><!----></div></div><!----><div class="VPContent" id="VPContent" data-v-9d8abc1e data-v-3cf691b6><div class="VPDoc has-aside" data-v-3cf691b6 data-v-a3c25e27><!--[--><!--]--><div class="container" data-v-a3c25e27><div class="aside" data-v-a3c25e27><div class="aside-curtain" data-v-a3c25e27></div><div class="aside-container" data-v-a3c25e27><div class="aside-content" data-v-a3c25e27><div class="VPDocAside" data-v-a3c25e27 data-v-cb998dce><!--[--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline" role="navigation" data-v-cb998dce data-v-3a6c4994><div class="content" data-v-3a6c4994><div class="outline-marker" data-v-3a6c4994></div><div class="outline-title" role="heading" aria-level="2" data-v-3a6c4994>文章摘要</div><nav aria-labelledby="doc-outline-aria-label" data-v-3a6c4994><span class="visually-hidden" id="doc-outline-aria-label" data-v-3a6c4994> Table of Contents for current page </span><ul class="root" data-v-3a6c4994 data-v-463da30f><!--[--><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-cb998dce></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-a3c25e27><div class="content-container" data-v-a3c25e27><!--[--><!--]--><!----><main class="main" data-v-a3c25e27><div style="position:relative;" class="vp-doc _posts_CUDA" data-v-a3c25e27><div><h1 id="入门-with-c" tabindex="-1">入门(with C++) <a class="header-anchor" href="#入门-with-c" aria-label="Permalink to &quot;入门(with C++)&quot;">​</a></h1><p>参考<a href="https://developer.nvidia.cn/cuda-gpus#collapseOne" target="_blank" rel="noreferrer">Nvida-zh</a>了解支持CUDA的Nvida GPU型号。</p><h2 id="hello-world" tabindex="-1">Hello World <a class="header-anchor" href="#hello-world" aria-label="Permalink to &quot;Hello World&quot;">​</a></h2><p>核函数使用<code>__global__</code>进行修饰，其返回类型必须是<code>void</code>类型。在核函数中可以使用<code>return</code>关键字但不会返回任何值。核函数无法成为一个类的成员，通常情况下，使用一个包装函数对核函数进行调用，将包装函数定义为类的成员。</p><div class="language-cpp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes nord nord vp-code"><code><span class="line"><span style="--shiki-light:#5E81AC;--shiki-dark:#5E81AC;--shiki-light-font-weight:bold;--shiki-dark-font-weight:bold;">#</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">include</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;"> &lt;</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;">stdio.h</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">__global__ </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">void</span><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;"> hello_world2gpu</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(){</span></span>
<span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">    printf</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;">Hello world, from GPU.</span><span style="--shiki-light:#EBCB8B;--shiki-dark:#EBCB8B;">\n</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span><span style="--shiki-light:#616E88;--shiki-dark:#616E88;"> //nvcc不支持cout&lt;&lt;方式输出</span></span>
<span class="line"><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">int</span><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;"> main</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">void</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">){</span></span>
<span class="line"><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">    hello_world2gpu</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">&lt;&lt;&lt;</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;">1</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;">1</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">&gt;&gt;&gt;</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">()</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span><span style="--shiki-light:#616E88;--shiki-dark:#616E88;"> // &lt;&lt;&lt;grid_size,block_size&gt;&gt;&gt;配置线程 线程块数量-单个块线程数量</span></span>
<span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">    cudaDeviceSynchronize</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">()</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span><span style="--shiki-light:#616E88;--shiki-dark:#616E88;"> // 同步函数</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">    return</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;"> 0</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">}</span></span></code></pre></div><div class="language-zsh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">zsh</span><pre class="shiki shiki-themes nord nord vp-code"><code><span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">nvcc</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;"> Hello2thread.cu</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;"> -o</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;"> Ex1</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;"> -arch=compute_61</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;"> -code=sm_80</span></span></code></pre></div><p><code>-arch=compute_xx</code>指定虚拟架构，<code>-code=sm_xx</code>指定真实计算能力，实践中保持兼容性的条件下，虚拟架构尽可能小，真实架构尽可能大。<br> 同时，为保证兼容性，可以指定多组计算能力，例如</p><div class="language-zsh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">zsh</span><pre class="shiki shiki-themes nord nord vp-code"><code><span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">nvcc</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;"> Hello2thread.cu</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;"> -o</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;"> Ex2_fat</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;"> -gencode</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;"> arch=compute_50,code=sm_50</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;"> -gencode</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;"> arch=compute_60,code=sm_60</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;"> -gencode</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;"> arch=compute_70,code=sm_70</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;"> -gencode</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;"> arch=compute_80,code=sm_80</span></span></code></pre></div><p>生成的可执行文件称为胖二进制文件，注意过多制定计算能力会增加编译时间和可执行文件的大小。</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>注意网格与线程块大小具有限制，通常，网格大小在<mjx-container class="MathJax" jax="SVG" style="direction:ltr;position:relative;"><svg style="overflow:visible;min-height:1px;min-width:1px;vertical-align:-0.464ex;" xmlns="http://www.w3.org/2000/svg" width="5.467ex" height="1.464ex" role="img" focusable="false" viewBox="0 -442 2416.3 647" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z" style="stroke-width:3;"></path></g><g data-mml-node="mo" transform="translate(572,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(1016.7,0)"><path data-c="1D466" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z" style="stroke-width:3;"></path></g><g data-mml-node="mo" transform="translate(1506.7,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(1951.3,0)"><path data-c="1D467" d="M347 338Q337 338 294 349T231 360Q211 360 197 356T174 346T162 335T155 324L153 320Q150 317 138 317Q117 317 117 325Q117 330 120 339Q133 378 163 406T229 440Q241 442 246 442Q271 442 291 425T329 392T367 375Q389 375 411 408T434 441Q435 442 449 442H462Q468 436 468 434Q468 430 463 420T449 399T432 377T418 358L411 349Q368 298 275 214T160 106L148 94L163 93Q185 93 227 82T290 71Q328 71 360 90T402 140Q406 149 409 151T424 153Q443 153 443 143Q443 138 442 134Q425 72 376 31T278 -11Q252 -11 232 6T193 40T155 57Q111 57 76 -3Q70 -11 59 -11H54H41Q35 -5 35 -2Q35 13 93 84Q132 129 225 214T340 322Q352 338 347 338Z" style="stroke-width:3;"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top:0px;left:0px;clip:rect(1px, 1px, 1px, 1px);-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;padding:1px 0px 0px 0px;border:0px;display:block;width:auto;overflow:hidden;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>z</mi></math></mjx-assistive-mml></mjx-container>上最大允许<mjx-container class="MathJax" jax="SVG" style="direction:ltr;position:relative;"><svg style="overflow:visible;min-height:1px;min-width:1px;vertical-align:-0.186ex;" xmlns="http://www.w3.org/2000/svg" width="6.816ex" height="2.072ex" role="img" focusable="false" viewBox="0 -833.9 3012.6 915.9" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mn"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z" style="stroke-width:3;"></path></g><g data-mml-node="TeXAtom" transform="translate(533,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mn"><path data-c="33" d="M127 463Q100 463 85 480T69 524Q69 579 117 622T233 665Q268 665 277 664Q351 652 390 611T430 522Q430 470 396 421T302 350L299 348Q299 347 308 345T337 336T375 315Q457 262 457 175Q457 96 395 37T238 -22Q158 -22 100 21T42 130Q42 158 60 175T105 193Q133 193 151 175T169 130Q169 119 166 110T159 94T148 82T136 74T126 70T118 67L114 66Q165 21 238 21Q293 21 321 74Q338 107 338 175V195Q338 290 274 322Q259 328 213 329L171 330L168 332Q166 335 166 348Q166 366 174 366Q202 366 232 371Q266 376 294 413T322 525V533Q322 590 287 612Q265 626 240 626Q208 626 181 615T143 592T132 580H135Q138 579 143 578T153 573T165 566T175 555T183 540T186 520Q186 498 172 481T127 463Z" style="stroke-width:3;"></path><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" transform="translate(500,0)" style="stroke-width:3;"></path></g></g></g><g data-mml-node="mo" transform="translate(1512.3,0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z" style="stroke-width:3;"></path></g><g data-mml-node="mn" transform="translate(2512.6,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" style="stroke-width:3;"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top:0px;left:0px;clip:rect(1px, 1px, 1px, 1px);-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;padding:1px 0px 0px 0px;border:0px;display:block;width:auto;overflow:hidden;"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>2</mn><mrow data-mjx-texclass="ORD"><mn>31</mn></mrow></msup><mo>−</mo><mn>1</mn></math></mjx-assistive-mml></mjx-container>, 65535, 65535。线程块大小在<mjx-container class="MathJax" jax="SVG" style="direction:ltr;position:relative;"><svg style="overflow:visible;min-height:1px;min-width:1px;vertical-align:-0.464ex;" xmlns="http://www.w3.org/2000/svg" width="5.467ex" height="1.464ex" role="img" focusable="false" viewBox="0 -442 2416.3 647" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z" style="stroke-width:3;"></path></g><g data-mml-node="mo" transform="translate(572,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(1016.7,0)"><path data-c="1D466" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z" style="stroke-width:3;"></path></g><g data-mml-node="mo" transform="translate(1506.7,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(1951.3,0)"><path data-c="1D467" d="M347 338Q337 338 294 349T231 360Q211 360 197 356T174 346T162 335T155 324L153 320Q150 317 138 317Q117 317 117 325Q117 330 120 339Q133 378 163 406T229 440Q241 442 246 442Q271 442 291 425T329 392T367 375Q389 375 411 408T434 441Q435 442 449 442H462Q468 436 468 434Q468 430 463 420T449 399T432 377T418 358L411 349Q368 298 275 214T160 106L148 94L163 93Q185 93 227 82T290 71Q328 71 360 90T402 140Q406 149 409 151T424 153Q443 153 443 143Q443 138 442 134Q425 72 376 31T278 -11Q252 -11 232 6T193 40T155 57Q111 57 76 -3Q70 -11 59 -11H54H41Q35 -5 35 -2Q35 13 93 84Q132 129 225 214T340 322Q352 338 347 338Z" style="stroke-width:3;"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top:0px;left:0px;clip:rect(1px, 1px, 1px, 1px);-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;padding:1px 0px 0px 0px;border:0px;display:block;width:auto;overflow:hidden;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>z</mi></math></mjx-assistive-mml></mjx-container>分别为1024, 1024, 1024且总的线程块大小不超过1024。</p></div><h2 id="nvcc即时编译" tabindex="-1">NVCC即时编译 <a class="header-anchor" href="#nvcc即时编译" aria-label="Permalink to &quot;NVCC即时编译&quot;">​</a></h2><p>参考<a href="https://zhuanlan.zhihu.com/p/432674688" target="_blank" rel="noreferrer">知乎</a><br> 大概用于在当前架构下生成更前向的虚拟架构的PTX代码，此时指定的两个计算能力都是虚拟架构的计算能力，且必须一致，例如： 若本人GPU不支持80架构</p><div class="language-zsh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">zsh</span><pre class="shiki shiki-themes nord nord vp-code"><code><span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">nvcc</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;"> Hello2thread.cu</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;"> -o</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;"> Ex2_fat</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;"> -gencode</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;"> arch=compute_50,code=sm_50</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;"> -gencode</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;"> arch=compute_60,code=sm_60</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;"> -gencode</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;"> arch=compute_70,code=sm_70</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;"> -gencode</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;"> arch=compute_80,code=compute_80</span></span></code></pre></div><h2 id="cuda矩阵加法" tabindex="-1">CUDA矩阵加法 <a class="header-anchor" href="#cuda矩阵加法" aria-label="Permalink to &quot;CUDA矩阵加法&quot;">​</a></h2><p>代码参考<a href="https://github.com/sangyc10/CUDA-code/tree/master/3.1lesson" target="_blank" rel="noreferrer">github</a></p><h3 id="cuda程序框架" tabindex="-1">CUDA程序框架 <a class="header-anchor" href="#cuda程序框架" aria-label="Permalink to &quot;CUDA程序框架&quot;">​</a></h3><ul><li>设置GPU</li></ul><div class="language-cpp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes nord nord vp-code"><code><span class="line"><span style="--shiki-light:#5E81AC;--shiki-dark:#5E81AC;--shiki-light-font-weight:bold;--shiki-dark-font-weight:bold;">#</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">include</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;"> &lt;</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;">stdio.h</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">&gt;</span><span style="--shiki-light:#616E88;--shiki-dark:#616E88;"> // 头文件</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">int</span><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;"> main</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">void</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">){</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">    int</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> iDeviceCount</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">=</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;">0</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#8FBCBB;--shiki-dark:#8FBCBB;">    cudaError_t</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> cudaStatus </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">=</span><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;"> cudaGetDeviceCount</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">&amp;</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">iDeviceCount</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span><span style="--shiki-light:#616E88;--shiki-dark:#616E88;"> // 获取GPU数量，成功返回cudaSuccess</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">    if</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;"> (</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">cudaStatus </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">!=</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> cudaSuccess </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">||</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> iDeviceCount </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">==</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;"> 0</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">){</span></span>
<span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">        printf</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;">No CUDA camptable GPU found! </span><span style="--shiki-light:#EBCB8B;--shiki-dark:#EBCB8B;">\n</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">        exit</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">-</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;">1</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">    }</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">    else</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">{</span></span>
<span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">        printf</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;">The count of GPUs is %d. </span><span style="--shiki-light:#EBCB8B;--shiki-dark:#EBCB8B;">\n</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">iDeviceCount</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">    int</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> iDev </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">=</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;"> 0</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">    cudaStatus </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">=</span><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;"> cudaSetDevice</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">iDev</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span><span style="--shiki-light:#616E88;--shiki-dark:#616E88;"> // host 设置GPU</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">    if</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;"> (</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">cudaStatus </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">!=</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> cudaSuccess</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">){</span></span>
<span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">        printf</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;">Fail to set GPU %d for computing. </span><span style="--shiki-light:#EBCB8B;--shiki-dark:#EBCB8B;">\n</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">iDev</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">        exit</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">-</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;">1</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">    }</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">    else</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">{</span></span>
<span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">        printf</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;">Set GPU successfully. </span><span style="--shiki-light:#EBCB8B;--shiki-dark:#EBCB8B;">\n</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">    }</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">    return</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;"> 0</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">}</span></span></code></pre></div><h3 id="内存管理" tabindex="-1">内存管理 <a class="header-anchor" href="#内存管理" aria-label="Permalink to &quot;内存管理&quot;">​</a></h3><p>参考<a href="https://www.runoob.com/cprogramming/c-memory-management.html" target="_blank" rel="noreferrer">菜鸟教程</a></p><h3 id="自定义设备函数" tabindex="-1">自定义设备函数 <a class="header-anchor" href="#自定义设备函数" aria-label="Permalink to &quot;自定义设备函数&quot;">​</a></h3><ul><li>设备函数使用<code>__device__</code>修饰</li><li>核函数使用<code>__global__</code>函数修饰，一般由主机调用，设备执行。(也存在核函数中调用核函数的现象，此时由设备调用)</li><li><code>__global__</code>不能和<code>__host__</code>，<code>__device__</code>同时使用。</li><li>主机函数使用<code>__host__</code>修饰，对于主机端的函数，该修饰符可省略。</li><li>若函数需在主机和设备中运行，可使用<code>__host__</code>, <code>__device__</code>同时修饰该函数，此时编译器会针对主机和设备分别编译该函数，减少冗余代码。</li></ul><h2 id="cuda错误检查" tabindex="-1">CUDA错误检查 <a class="header-anchor" href="#cuda错误检查" aria-label="Permalink to &quot;CUDA错误检查&quot;">​</a></h2><p>CUDA错误会发生在两个阶段——编译时错误，运行时错误。编译时发生错误编译器会将错误所在位置进行返回。</p><h3 id="runtime-api-错误" tabindex="-1">Runtime API 错误 <a class="header-anchor" href="#runtime-api-错误" aria-label="Permalink to &quot;Runtime API 错误&quot;">​</a></h3><p>参考<a href="https://docs.nvidia.com/cuda/cuda-runtime-api/group__CUDART__TYPES.html#group__CUDART__TYPES_1g3f51e3575c2178246db0a94a430e0038" target="_blank" rel="noreferrer">Nvida官方文档</a></p><h3 id="错误检查函数" tabindex="-1">错误检查函数 <a class="header-anchor" href="#错误检查函数" aria-label="Permalink to &quot;错误检查函数&quot;">​</a></h3><p><code>cudaGetErrorName</code>: 获取错误代码对应的错误名称，返回 <code>char *</code>类型<br><code>cudaGetErrorString</code>: 获取错误代码的描述信息，返回<code>char *</code>类型</p><div class="language-cpp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes nord nord vp-code"><code><span class="line"><span style="--shiki-light:#5E81AC;--shiki-dark:#5E81AC;--shiki-light-font-weight:bold;--shiki-dark-font-weight:bold;">#</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">include</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;"> &lt;</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;">stdio.h</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#8FBCBB;--shiki-dark:#8FBCBB;">cudaError_t</span><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;"> ErrorCheck</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#8FBCBB;--shiki-dark:#8FBCBB;">cudaError_t</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;"> error_code</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> const</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> char*</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;"> filename</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> int</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;"> linenum</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">){</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">    if</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;"> (</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">error_code </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">!=</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> cudaSuccess</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">){</span></span>
<span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">        printf</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;">Cuda_Error:</span><span style="--shiki-light:#EBCB8B;--shiki-dark:#EBCB8B;">\n</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;">code:%d, name:%s, description:%s</span><span style="--shiki-light:#EBCB8B;--shiki-dark:#EBCB8B;">\n</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;"> file:%s, line:%d</span><span style="--shiki-light:#EBCB8B;--shiki-dark:#EBCB8B;">\n</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;"> &quot;</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span></span>
<span class="line"><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">        error_code</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">cudaGetErrorName</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">error_code</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">),</span><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">cudaGetErrorString</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">error_code</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">),</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">filename</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">linenum</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">    }</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">    return</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> error_code</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">}</span></span></code></pre></div><h3 id="检查核函数" tabindex="-1">检查核函数 <a class="header-anchor" href="#检查核函数" aria-label="Permalink to &quot;检查核函数&quot;">​</a></h3><p>错误检查函数无法捕捉调用核函数相关错误，由于<code>__global__ void</code>，核函数不会返回错误值，可使用如下代码捕捉核函数中的可能错误。</p><div class="language-c++ vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c++</span><pre class="shiki shiki-themes nord nord vp-code"><code><span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">ErrorCheck</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">cudaGetLastError</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(),</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">__FILE__</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">__LINE__</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span><span style="--shiki-light:#616E88;--shiki-dark:#616E88;">// 返回上一条cuda_Error</span></span>
<span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">ErrorCheck</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">cudaDeviceSynchronize</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(),</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">__FILE__</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">__LINE__</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span><span style="--shiki-light:#616E88;--shiki-dark:#616E88;"> //由于CPU与GPU异步，需在此加入一个同步函数，等待核函数运行完成。</span></span></code></pre></div><h2 id="cuda记时" tabindex="-1">CUDA记时 <a class="header-anchor" href="#cuda记时" aria-label="Permalink to &quot;CUDA记时&quot;">​</a></h2><h3 id="事件记时" tabindex="-1">事件记时 <a class="header-anchor" href="#事件记时" aria-label="Permalink to &quot;事件记时&quot;">​</a></h3><p>程序执行时间计时，是CUDA程序执行性能的重要表现，使用<a href="https://developer.download.nvidia.cn/compute/DevZone/docs/html/C/doc/html/group__CUDART__EVENT.html" target="_blank" rel="noreferrer">事件记时</a>方式。框架如下</p><div class="language-c++ vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c++</span><pre class="shiki shiki-themes nord nord vp-code"><code><span class="line"><span style="--shiki-light:#8FBCBB;--shiki-dark:#8FBCBB;">cudaEvent_t</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> start</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> stop</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span><span style="--shiki-light:#616E88;--shiki-dark:#616E88;"> // 定义用来记时的CUDA事件变量</span></span>
<span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">ErrorCheck</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">cudaEventCreate</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">&amp;</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">start</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">),</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> __FILE__</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> __LINE__</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span><span style="--shiki-light:#616E88;--shiki-dark:#616E88;"> //初始化事件</span></span>
<span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">ErrorCheck</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">cudaEventCreate</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">&amp;</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">stop</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">),</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> __FILE__</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> __LINE__</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">ErrorCheck</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">cudaEventRecord</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">start</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">),</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> __FILE__</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> __LINE__</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span><span style="--shiki-light:#616E88;--shiki-dark:#616E88;"> // 记录代表时间开始的事件</span></span>
<span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">cudaEventQuery</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">start</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span><span style="--shiki-light:#616E88;--shiki-dark:#616E88;">	//此处不可用错误检测函数，cudaErrorNotReady</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">addFromGPU</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">&lt;&lt;&lt;</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">grid</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> block</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">&gt;&gt;&gt;</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">fpDevice_A</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> fpDevice_B</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> fpDevice_C</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> iElemCount</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span><span style="--shiki-light:#616E88;--shiki-dark:#616E88;">    // 核函数，需要记时的代码</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">ErrorCheck</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">cudaEventRecord</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">stop</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">),</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> __FILE__</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> __LINE__</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span><span style="--shiki-light:#616E88;--shiki-dark:#616E88;"> // 记录代表时间结束的事件</span></span>
<span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">ErrorCheck</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">cudaEventSynchronize</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">stop</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">),</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> __FILE__</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> __LINE__</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">float</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> elapsed_time</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">ErrorCheck</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">cudaEventElapsedTime</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">&amp;</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">elapsed_time</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> start</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> stop</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">),</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> __FILE__</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> __LINE__</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span><span style="--shiki-light:#616E88;--shiki-dark:#616E88;"> //计算两个work间的elapsed time</span></span>
<span class="line"><span style="--shiki-light:#616E88;--shiki-dark:#616E88;">// printf(&quot;Time = %g ms.\n&quot;, elapsed_time);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">if</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;"> (</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">repeat </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">&gt;</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;"> 0</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#616E88;--shiki-dark:#616E88;"> // 不计入第0次的情况，这是由于第一次调用核函数往往时间更多</span></span>
<span class="line"><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">{</span></span>
<span class="line"><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">    t_sum </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">+=</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> elapsed_time</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">ErrorCheck</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">cudaEventDestroy</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">start</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">),</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> __FILE__</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> __LINE__</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span><span style="--shiki-light:#616E88;--shiki-dark:#616E88;"> // 销毁前面定义的时间类型变量</span></span>
<span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">ErrorCheck</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">cudaEventDestroy</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">stop</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">),</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> __FILE__</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> __LINE__</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span></code></pre></div><h3 id="nvprof-性能刨析工具" tabindex="-1">nvprof 性能刨析工具 <a class="header-anchor" href="#nvprof-性能刨析工具" aria-label="Permalink to &quot;nvprof 性能刨析工具&quot;">​</a></h3><p><code>nvprof</code>是一个可执行文件，执行方式为: <code>nvprof ./exe_name</code>。</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>目前较新的GPU可能不再支持nvprof，可替换为Nsight System，Arch系统下包含在cuda-tools包中，执行nsys进行分析。</p></div><h2 id="运行时gpu信息的查询" tabindex="-1">运行时GPU信息的查询 <a class="header-anchor" href="#运行时gpu信息的查询" aria-label="Permalink to &quot;运行时GPU信息的查询&quot;">​</a></h2><p>查询熟知自身GPU性各项能才能高效进行CUDA程序开发，参考<a href="https://developer.download.nvidia.cn/compute/DevZone/docs/html/C/doc/html/group__CUDART__DEVICE.html" target="_blank" rel="noreferrer">Nvida doc</a></p><h3 id="gpu性能评价指标" tabindex="-1">GPU性能评价指标 <a class="header-anchor" href="#gpu性能评价指标" aria-label="Permalink to &quot;GPU性能评价指标&quot;">​</a></h3><ul><li>浮点数运算峰值，FLOPS</li><li>GPU内存、带宽。</li></ul><h3 id="运行时api查询gpu信息" tabindex="-1">运行时API查询GPU信息 <a class="header-anchor" href="#运行时api查询gpu信息" aria-label="Permalink to &quot;运行时API查询GPU信息&quot;">​</a></h3><p>GPU硬件知识参考<a href="https://zhuanlan.zhihu.com/p/462191421" target="_blank" rel="noreferrer">知乎</a>，<code>prop</code>结构体中包含的信息参考<a href="https://developer.download.nvidia.cn/compute/DevZone/docs/html/C/doc/html/group__CUDART__DEVICE_g5aa4f47938af8276f08074d09b7d520c.html#g5aa4f47938af8276f08074d09b7d520c" target="_blank" rel="noreferrer">Nvida</a></p><div class="language-c++ vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c++</span><pre class="shiki shiki-themes nord nord vp-code"><code><span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">int</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> device_id </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">=</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;"> 0</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span><span style="--shiki-light:#616E88;--shiki-dark:#616E88;"> // 设置设备ID</span></span>
<span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">ErrorCheck</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">cudaSetDevice</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">device_id</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">),</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> __FILE__</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> __LINE__</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span><span style="--shiki-light:#616E88;--shiki-dark:#616E88;"> // 设置使用的GPU</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">cudaDeviceProp prop</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span><span style="--shiki-light:#616E88;--shiki-dark:#616E88;"> // 结构体，存储GPU相关属性</span></span>
<span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">ErrorCheck</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">cudaGetDeviceProperties</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">&amp;</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">prop</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> device_id</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">),</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> __FILE__</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> __LINE__</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span></code></pre></div><h3 id="查询gpu计算核心数量" tabindex="-1">查询GPU计算核心数量 <a class="header-anchor" href="#查询gpu计算核心数量" aria-label="Permalink to &quot;查询GPU计算核心数量&quot;">​</a></h3><p>无运行时API可直接查询，根据其主版本号，次版本号及SM数量，使用下面函数可计算</p><div class="language-c++ vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c++</span><pre class="shiki shiki-themes nord nord vp-code"><code><span class="line"><span style="--shiki-light:#5E81AC;--shiki-dark:#5E81AC;--shiki-light-font-weight:bold;--shiki-dark-font-weight:bold;">#</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">include</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;"> &lt;</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;">stdio.h</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#5E81AC;--shiki-dark:#5E81AC;--shiki-light-font-weight:bold;--shiki-dark-font-weight:bold;">#</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">include</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;"> &quot;</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;">./tools/setDevice.cuh</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">int</span><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;"> getSPcores</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">cudaDeviceProp </span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">devProp</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span></span>
<span class="line"><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">{</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">  </span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">    int</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> cores </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">=</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;"> 0</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">    int</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> mp </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">=</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;"> devProp</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">multiProcessorCount</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">    switch</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;"> (</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">devProp</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">major</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">){</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">     case</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;"> 2</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">:</span><span style="--shiki-light:#616E88;--shiki-dark:#616E88;"> // Fermi</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">      if</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;"> (</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">devProp</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">minor</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> ==</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;"> 1</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> cores </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">=</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> mp </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">*</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;"> 48</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">      else</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> cores </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">=</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> mp </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">*</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;"> 32</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">      break;</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">     case</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;"> 3</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">:</span><span style="--shiki-light:#616E88;--shiki-dark:#616E88;"> // Kepler</span></span>
<span class="line"><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">      cores </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">=</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> mp </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">*</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;"> 192</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">      break;</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">     case</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;"> 5</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">:</span><span style="--shiki-light:#616E88;--shiki-dark:#616E88;"> // Maxwell</span></span>
<span class="line"><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">      cores </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">=</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> mp </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">*</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;"> 128</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">      break;</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">     case</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;"> 6</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">:</span><span style="--shiki-light:#616E88;--shiki-dark:#616E88;"> // Pascal</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">      if</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;"> ((</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">devProp</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">minor</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> ==</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;"> 1</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> ||</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;"> (</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">devProp</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">minor</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> ==</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;"> 2</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">))</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> cores </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">=</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> mp </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">*</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;"> 128</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">      else</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> if</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;"> (</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">devProp</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">minor</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> ==</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;"> 0</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> cores </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">=</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> mp </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">*</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;"> 64</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">      else</span><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;"> printf</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;">Unknown device type</span><span style="--shiki-light:#EBCB8B;--shiki-dark:#EBCB8B;">\n</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">      break;</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">     case</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;"> 7</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">:</span><span style="--shiki-light:#616E88;--shiki-dark:#616E88;"> // Volta and Turing</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">      if</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;"> ((</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">devProp</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">minor</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> ==</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;"> 0</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> ||</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;"> (</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">devProp</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">minor</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> ==</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;"> 5</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">))</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> cores </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">=</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> mp </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">*</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;"> 64</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">      else</span><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;"> printf</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;">Unknown device type</span><span style="--shiki-light:#EBCB8B;--shiki-dark:#EBCB8B;">\n</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">      break;</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">     case</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;"> 8</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">:</span><span style="--shiki-light:#616E88;--shiki-dark:#616E88;"> // Ampere</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">      if</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;"> (</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">devProp</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">minor</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> ==</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;"> 0</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> cores </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">=</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> mp </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">*</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;"> 64</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">      else</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> if</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;"> (</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">devProp</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">minor</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> ==</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;"> 6</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> cores </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">=</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> mp </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">*</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;"> 128</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">      else</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> if</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;"> (</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">devProp</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">minor</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> ==</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;"> 9</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> cores </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">=</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> mp </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">*</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;"> 128</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span><span style="--shiki-light:#616E88;--shiki-dark:#616E88;"> // ada lovelace</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">      else</span><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;"> printf</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;">Unknown device type</span><span style="--shiki-light:#EBCB8B;--shiki-dark:#EBCB8B;">\n</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">      break;</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">     case</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;"> 9</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">:</span><span style="--shiki-light:#616E88;--shiki-dark:#616E88;"> // Hopper</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">      if</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;"> (</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">devProp</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">minor</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> ==</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;"> 0</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> cores </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">=</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> mp </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">*</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;"> 128</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">      else</span><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;"> printf</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;">Unknown device type</span><span style="--shiki-light:#EBCB8B;--shiki-dark:#EBCB8B;">\n</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">      break;</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">     default</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">:</span></span>
<span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">      printf</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;">Unknown device type</span><span style="--shiki-light:#EBCB8B;--shiki-dark:#EBCB8B;">\n</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> </span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">      break;</span></span>
<span class="line"><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">      }</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">    return</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> cores</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">int</span><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;"> main</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">()</span></span>
<span class="line"><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">{</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">    int</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> device_id </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">=</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;"> 0</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">    ErrorCheck</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">cudaSetDevice</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">device_id</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">),</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> __FILE__</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> __LINE__</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">    </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">    cudaDeviceProp prop</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">    ErrorCheck</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">cudaGetDeviceProperties</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">&amp;</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">prop</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> device_id</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">),</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> __FILE__</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> __LINE__</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">    printf</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;">Compute cores is %d.</span><span style="--shiki-light:#EBCB8B;--shiki-dark:#EBCB8B;">\n</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;"> getSPcores</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">prop</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">))</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">    return</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;"> 0</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">}</span></span></code></pre></div><h2 id="组织线程模型" tabindex="-1">组织线程模型 <a class="header-anchor" href="#组织线程模型" aria-label="Permalink to &quot;组织线程模型&quot;">​</a></h2><p>数据在内存中以线性，以行为主的方式存储。发挥GPU中多线程的优点，就是要让每个线程处理不同的数据运算，必须合理的组织线程，避免多个线程处理同一数据或胡乱访问内存的情况出现。</p><h3 id="二维网格二维线程块" tabindex="-1">二维网格二维线程块 <a class="header-anchor" href="#二维网格二维线程块" aria-label="Permalink to &quot;二维网格二维线程块&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes nord nord vp-code"><code><span class="line"><span>ix = threadIdx.x + blockIdx.x*blockDim.x;</span></span>
<span class="line"><span>iy = threadIdx.y + blockIdx.y+blockDim.y;</span></span>
<span class="line"><span>idx = iy*nx + ix;</span></span></code></pre></div><h3 id="二维网格一维线程块" tabindex="-1">二维网格一维线程块 <a class="header-anchor" href="#二维网格一维线程块" aria-label="Permalink to &quot;二维网格一维线程块&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes nord nord vp-code"><code><span class="line"><span>ix = threadIdx.x + blockIdx.x * blockDim.x;</span></span>
<span class="line"><span>iy = blockIdx.y;</span></span>
<span class="line"><span>idx = iy * nx + ix;</span></span></code></pre></div><h3 id="一维网格一维线程块" tabindex="-1">一维网格一维线程块 <a class="header-anchor" href="#一维网格一维线程块" aria-label="Permalink to &quot;一维网格一维线程块&quot;">​</a></h3><p>此时无法做到每个线程对应矩阵中一个元素，需要循环执行。</p><div class="language-c++ vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c++</span><pre class="shiki shiki-themes nord nord vp-code"><code><span class="line"><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">__global__ </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">void</span><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;"> addMatrix</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">int</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> *</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">A</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> int</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> *</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">B</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> int</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> *</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">C</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> const</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> int</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> nx</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> const</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> int</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> ny</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span></span>
<span class="line"><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">{</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">    int</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> ix </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">=</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;"> threadIdx</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">x</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> +</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;"> blockIdx</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">x</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> *</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;"> blockDim</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">x</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span><span style="--shiki-light:#616E88;--shiki-dark:#616E88;"> // 此时iy 由循环执行决定</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">    for</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;"> (</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">int</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> iy </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">=</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;"> 0</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> iy </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">&lt;</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> ny</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> iy</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">++</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span></span>
<span class="line"><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">    {</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">        int</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> idx </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">=</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> iy </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">*</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> nx </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">+</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> ix</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">        C</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">[</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">idx</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">]</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> =</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;"> A</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">[</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">idx</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">]</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> +</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;"> B</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">[</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">idx</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">]</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">    }</span></span>
<span class="line"><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">}</span></span></code></pre></div><h2 id="全局内存" tabindex="-1">全局内存 <a class="header-anchor" href="#全局内存" aria-label="Permalink to &quot;全局内存&quot;">​</a></h2><p>对全局内存的访问将触发内存事务，也就是数据传输。在线程访问内存引发数据传输的过程中，传输的数据有的是线程所需要的，而有的是额外数据，对他们的传输产生了资源浪费，使用合并度对资源利用率进行衡量。</p><h3 id="合并与非合并访问" tabindex="-1">合并与非合并访问 <a class="header-anchor" href="#合并与非合并访问" aria-label="Permalink to &quot;合并与非合并访问&quot;">​</a></h3><p>合并度等于线程束请求的字节数除以由该请求导致的数据传输处理的全部数据的字节数。当合并度为100%也就是说线程数对全局内存的一次访问请求导致了最少的数据传输，我们称该访问为合并访问，否则为非合并的。<br> 要分析一个访问是合并的还是非合并的，首先要明晰数据传对数据地址的要求(这里考虑全局内存的读取仅使用<mjx-container class="MathJax" jax="SVG" style="direction:ltr;position:relative;"><svg style="overflow:visible;min-height:1px;min-width:1px;vertical-align:-0.339ex;" xmlns="http://www.w3.org/2000/svg" width="2.528ex" height="1.885ex" role="img" focusable="false" viewBox="0 -683 1117.6 833" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D43F" d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 217 683Q271 680 344 680Q485 680 506 683H518Q524 677 524 674T522 656Q517 641 513 637H475Q406 636 394 628Q387 624 380 600T313 336Q297 271 279 198T252 88L243 52Q243 48 252 48T311 46H328Q360 46 379 47T428 54T478 72T522 106T564 161Q580 191 594 228T611 270Q616 273 628 273H641Q647 264 647 262T627 203T583 83T557 9Q555 4 553 3T537 0T494 -1Q483 -1 418 -1T294 0H116Q32 0 32 10Q32 17 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z" style="stroke-width:3;"></path></g><g data-mml-node="mn" transform="translate(714,-150) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z" style="stroke-width:3;"></path></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top:0px;left:0px;clip:rect(1px, 1px, 1px, 1px);-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;padding:1px 0px 0px 0px;border:0px;display:block;width:auto;overflow:hidden;"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>L</mi><mn>2</mn></msub></math></mjx-assistive-mml></mjx-container>缓存的情况)： 一次数据传输中从全局内存转移到<mjx-container class="MathJax" jax="SVG" style="direction:ltr;position:relative;"><svg style="overflow:visible;min-height:1px;min-width:1px;vertical-align:-0.339ex;" xmlns="http://www.w3.org/2000/svg" width="2.528ex" height="1.885ex" role="img" focusable="false" viewBox="0 -683 1117.6 833" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D43F" d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 217 683Q271 680 344 680Q485 680 506 683H518Q524 677 524 674T522 656Q517 641 513 637H475Q406 636 394 628Q387 624 380 600T313 336Q297 271 279 198T252 88L243 52Q243 48 252 48T311 46H328Q360 46 379 47T428 54T478 72T522 106T564 161Q580 191 594 228T611 270Q616 273 628 273H641Q647 264 647 262T627 203T583 83T557 9Q555 4 553 3T537 0T494 -1Q483 -1 418 -1T294 0H116Q32 0 32 10Q32 17 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z" style="stroke-width:3;"></path></g><g data-mml-node="mn" transform="translate(714,-150) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z" style="stroke-width:3;"></path></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top:0px;left:0px;clip:rect(1px, 1px, 1px, 1px);-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;padding:1px 0px 0px 0px;border:0px;display:block;width:auto;overflow:hidden;"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>L</mi><mn>2</mn></msub></math></mjx-assistive-mml></mjx-container>缓存的一片内存的首地址，一定是最小粒度的整数倍(这里为32)。例如，一次传输只能从全局内存中读取地址为0到31字节。以线程请求访问单精度浮点数(4字节)为例，一个线程束总共需要访问128字节，若这128字节的地址恰好为0到127，则此时仅4次传输即可，此时合并度为100%，为合并访问。 下面给出实例</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>CUDA运行时API cudaMalloc()分配内存的首地址至少为256字节的整数倍。</p></div><div class="language-c++ vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c++</span><pre class="shiki shiki-themes nord nord vp-code"><code><span class="line"><span style="--shiki-light:#616E88;--shiki-dark:#616E88;">// 合并访问</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">void</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> __global__ </span><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">add</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">float</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> *</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">x</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> float</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> *</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">y</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> float</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> *</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">z</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">){</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">    int</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> n </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">=</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;"> threadIdx</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">x</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> +</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;"> blockIdx</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">x</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">*</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">blockDim</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">x</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">    z</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">[</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">n</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">]</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> =</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;"> x</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">[</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">n</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">]</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> +</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;"> y</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">[</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">n</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">]</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">}</span></span>
<span class="line"><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">add</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">&lt;&lt;&lt;</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;">128</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;">32</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">&gt;&gt;&gt;</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">x</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">y</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">z</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span></span></code></pre></div><p>可以看到，核函数中对这几个指针的访问都是合并的。例如，在第一个线程块中的线程束将访问数组中的0到31个数据，对应着0到127字节的连续内存，是合并访问。</p><div class="language-c++ vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c++</span><pre class="shiki shiki-themes nord nord vp-code"><code><span class="line"><span style="--shiki-light:#616E88;--shiki-dark:#616E88;">// 非合并访问</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">void</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> __global__ </span><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">add</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">float</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> *</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">x</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> float</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> *</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">y</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> float</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> *</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">z</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">){</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">    int</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> n </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">=</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;"> blockIdx</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">x</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> +</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;"> threadIdx</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">x</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">*</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">gridDim</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">x</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">    z</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">[</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">n</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">]</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> =</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;"> x</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">[</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">n</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">]</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> +</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;"> y</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">[</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">n</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">]</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">}</span></span>
<span class="line"><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">add</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">&lt;&lt;&lt;</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;">128</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;">32</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">&gt;&gt;&gt;</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">x</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">y</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">z</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span></span></code></pre></div><p>如上，第一个线程块中的线程束将对数组中第0, 128, 256...元素进行访问，都不在同一个连续32字节的内存片段中，故需要访问32次，此时合并率为<mjx-container class="MathJax" jax="SVG" style="direction:ltr;position:relative;"><svg style="overflow:visible;min-height:1px;min-width:1px;vertical-align:-0.816ex;" xmlns="http://www.w3.org/2000/svg" width="11.52ex" height="2.79ex" role="img" focusable="false" viewBox="0 -872.7 5091.7 1233.3" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mfrac"><g data-mml-node="mn" transform="translate(396.8,394) scale(0.707)"><path data-c="34" d="M462 0Q444 3 333 3Q217 3 199 0H190V46H221Q241 46 248 46T265 48T279 53T286 61Q287 63 287 115V165H28V211L179 442Q332 674 334 675Q336 677 355 677H373L379 671V211H471V165H379V114Q379 73 379 66T385 54Q393 47 442 46H471V0H462ZM293 211V545L74 212L183 211H293Z" style="stroke-width:3;"></path></g><g data-mml-node="mn" transform="translate(220,-345) scale(0.707)"><path data-c="33" d="M127 463Q100 463 85 480T69 524Q69 579 117 622T233 665Q268 665 277 664Q351 652 390 611T430 522Q430 470 396 421T302 350L299 348Q299 347 308 345T337 336T375 315Q457 262 457 175Q457 96 395 37T238 -22Q158 -22 100 21T42 130Q42 158 60 175T105 193Q133 193 151 175T169 130Q169 119 166 110T159 94T148 82T136 74T126 70T118 67L114 66Q165 21 238 21Q293 21 321 74Q338 107 338 175V195Q338 290 274 322Q259 328 213 329L171 330L168 332Q166 335 166 348Q166 366 174 366Q202 366 232 371Q266 376 294 413T322 525V533Q322 590 287 612Q265 626 240 626Q208 626 181 615T143 592T132 580H135Q138 579 143 578T153 573T165 566T175 555T183 540T186 520Q186 498 172 481T127 463Z" style="stroke-width:3;"></path><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z" transform="translate(500,0)" style="stroke-width:3;"></path></g><rect width="907.1" height="60" x="120" y="220"></rect></g><g data-mml-node="mo" transform="translate(1424.9,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z" style="stroke-width:3;"></path></g><g data-mml-node="mn" transform="translate(2480.7,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" style="stroke-width:3;"></path><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z" transform="translate(500,0)" style="stroke-width:3;"></path><path data-c="2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z" transform="translate(1000,0)" style="stroke-width:3;"></path><path data-c="35" d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z" transform="translate(1278,0)" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(4258.7,0)"><path data-c="25" d="M465 605Q428 605 394 614T340 632T319 641Q332 608 332 548Q332 458 293 403T202 347Q145 347 101 402T56 548Q56 637 101 693T202 750Q241 750 272 719Q359 642 464 642Q580 642 650 732Q662 748 668 749Q670 750 673 750Q682 750 688 743T693 726Q178 -47 170 -52Q166 -56 160 -56Q147 -56 142 -45Q137 -36 142 -27Q143 -24 363 304Q469 462 525 546T581 630Q528 605 465 605ZM207 385Q235 385 263 427T292 548Q292 617 267 664T200 712Q193 712 186 709T167 698T147 668T134 615Q132 595 132 548V527Q132 436 165 403Q183 385 203 385H207ZM500 146Q500 234 544 290T647 347Q699 347 737 292T776 146T737 0T646 -56Q590 -56 545 0T500 146ZM651 -18Q679 -18 707 24T736 146Q736 215 711 262T644 309Q637 309 630 306T611 295T591 265T578 212Q577 200 577 146V124Q577 -18 647 -18H651Z" style="stroke-width:3;"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top:0px;left:0px;clip:rect(1px, 1px, 1px, 1px);-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;padding:1px 0px 0px 0px;border:0px;display:block;width:auto;overflow:hidden;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mn>4</mn><mn>32</mn></mfrac><mo>=</mo><mn>12.5</mn><mi mathvariant="normal">%</mi></math></mjx-assistive-mml></mjx-container>，为非合并访问。</p><h3 id="矩阵转置-例" tabindex="-1">矩阵转置(例) <a class="header-anchor" href="#矩阵转置-例" aria-label="Permalink to &quot;矩阵转置(例)&quot;">​</a></h3><p>下面为完整的矩阵转置的例子，代码中首先生成了一个给定大小的随机方阵，之后进行了转置并对核函数进行记时。值得一提的是，在两种核函数中都包含了一个合并访问和一个非合并访问，但其执行速度却不同。这是因为，如果编译器判断一个全局变量在整个核函数范围内只可读，则会自动使用<code>__ldg()</code>函数对数据的读取进行缓存，从而环节非合并访问带来的影响。而在写入操作是没有类似的函数可以调用的。</p><div class="language-c++ vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c++</span><pre class="shiki shiki-themes nord nord vp-code"><code><span class="line"><span style="--shiki-light:#5E81AC;--shiki-dark:#5E81AC;--shiki-light-font-weight:bold;--shiki-dark-font-weight:bold;">#</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">include</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;"> &lt;</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;">stdio.h</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#5E81AC;--shiki-dark:#5E81AC;--shiki-light-font-weight:bold;--shiki-dark-font-weight:bold;">#</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">include</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;"> &quot;</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;">./tools/setDevice.cuh</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#616E88;--shiki-dark:#616E88;">// 设计核函数</span></span>
<span class="line"><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">__global__ </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">void</span><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;"> transpose1</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">const</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> float</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> *</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">A</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">float</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> *</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">B</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> const</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> int</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> N</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">){</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">    const</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> int</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> nx </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">=</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;"> threadIdx</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">x</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> +</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;"> blockDim</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">x</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">*</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">blockIdx</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">x</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">    const</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> int</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> ny </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">=</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;"> threadIdx</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">y</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> +</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;"> blockDim</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">y</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">*</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">blockIdx</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">y</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">    if</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;"> (</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">nx </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">&lt;</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> N </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">&amp;&amp;</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> ny</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">&lt;</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> N</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">){</span></span>
<span class="line"><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">        B</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">[</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">nx</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">*</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">N </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">+</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> ny</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">]</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> =</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;"> A</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">[</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">ny</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">*</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">N</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">+</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">nx</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">]</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span><span style="--shiki-light:#616E88;--shiki-dark:#616E88;"> // 此时对于A的内存访问为合并的，即读合并，写非合并。</span></span>
<span class="line"><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">    }</span></span>
<span class="line"><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">__global__ </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">void</span><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;"> transpose2</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">const</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> float</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> *</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">A</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> float</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> *</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">B</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> const</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> int</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> N</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">){</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">    const</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> int</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> nx </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">=</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;"> threadIdx</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">x</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> +</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;"> blockDim</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">x</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">*</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">blockIdx</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">x</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">    const</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> int</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> ny </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">=</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;"> threadIdx</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">y</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> +</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;"> blockDim</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">y</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">*</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">blockIdx</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">y</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">    if</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;"> (</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">nx </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">&lt;</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> N </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">&amp;&amp;</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> ny</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">&lt;</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> N</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">){</span></span>
<span class="line"><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">        B</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">[</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">ny</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">*</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">N </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">+</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> nx</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">]</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> =</span><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;"> __ldg</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">&amp;</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">A</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">[</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">nx</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">*</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">N</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">+</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">ny</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">])</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span><span style="--shiki-light:#616E88;--shiki-dark:#616E88;"> // 此时对于B的内存访问为合并的，即写合并，读非合并。</span></span>
<span class="line"><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">    }</span></span>
<span class="line"><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">void</span><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;"> initialData</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">float</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> *</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">addr</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> int</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;"> elemCount</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span></span>
<span class="line"><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">{</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">    for</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;"> (</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">int</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> i </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">=</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;"> 0</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> i </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">&lt;</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> elemCount</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> i</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">++</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span></span>
<span class="line"><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">    {</span></span>
<span class="line"><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">        addr</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">[</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">i</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">]</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> =</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;"> (</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">float</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)(</span><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">rand</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">()</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> &amp;</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> 0x</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;">FF</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> /</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;"> 10.</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">f;</span><span style="--shiki-light:#616E88;--shiki-dark:#616E88;"> // 做逻辑与操作，限制随机数不超过255/10</span></span>
<span class="line"><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">    }</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">    return;</span></span>
<span class="line"><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">int</span><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;"> main</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">void</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">){</span></span>
<span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">    SetGPU</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">()</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span><span style="--shiki-light:#616E88;--shiki-dark:#616E88;"> // 设置GPU</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">    const</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> int</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> N </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">=</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;"> 128</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span><span style="--shiki-light:#616E88;--shiki-dark:#616E88;"> // 设置矩阵大小</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">    int</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> iElemCount </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">=</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> N</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">*</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">N</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span><span style="--shiki-light:#616E88;--shiki-dark:#616E88;">             // 设置元素数量</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">    size_t</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> stBytesCount </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">=</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> iElemCount </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">*</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> sizeof</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">float</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span><span style="--shiki-light:#616E88;--shiki-dark:#616E88;"> // 字节数</span></span>
<span class="line"><span style="--shiki-light:#616E88;--shiki-dark:#616E88;">    // 分配主机内存</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">    float</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> *</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">fpHost_A</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> *</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">fpHost_B</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">    fpHost_A </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">=</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;"> (</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">float</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> *</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">malloc</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">stBytesCount</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span><span style="--shiki-light:#616E88;--shiki-dark:#616E88;"> // 分配动态内存</span></span>
<span class="line"><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">    fpHost_B </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">=</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;"> (</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">float</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> *</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">malloc</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">stBytesCount</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">    if</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;"> (</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">fpHost_A </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">!=</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> NULL</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> &amp;&amp;</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> fpHost_B </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">!=</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> NULL</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span></span>
<span class="line"><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">    {</span></span>
<span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">        memset</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">fpHost_A</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;"> 0</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> stBytesCount</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span><span style="--shiki-light:#616E88;--shiki-dark:#616E88;">  // 主机内存初始化为0</span></span>
<span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">        memset</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">fpHost_B</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;"> 0</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> stBytesCount</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">    }</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">    else</span></span>
<span class="line"><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">    {</span></span>
<span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">        printf</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;">Fail to allocate host memory!</span><span style="--shiki-light:#EBCB8B;--shiki-dark:#EBCB8B;">\n</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">        exit</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">-</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;">1</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">    float</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> *</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">fpDevice_A</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> *</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">fpDevice_B</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">    ErrorCheck</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">cudaMalloc</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">((</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">float**</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">&amp;</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">fpDevice_A</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> stBytesCount</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">),</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> __FILE__</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> __LINE__</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">    ErrorCheck</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">cudaMalloc</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">((</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">float**</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">&amp;</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">fpDevice_B</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> stBytesCount</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">),</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> __FILE__</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> __LINE__</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">    if</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;"> (</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">fpDevice_A </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">!=</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> NULL</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> &amp;&amp;</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> fpDevice_B </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">!=</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> NULL</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">){</span></span>
<span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">    ErrorCheck</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">cudaMemset</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">fpDevice_A</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;"> 0</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> stBytesCount</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">),</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> __FILE__</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> __LINE__</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span><span style="--shiki-light:#616E88;--shiki-dark:#616E88;"> // 设备内存初始化为0</span></span>
<span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">    ErrorCheck</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">cudaMemset</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">fpDevice_B</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;"> 0</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> stBytesCount</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">),</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> __FILE__</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> __LINE__</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">    }</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">    else</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">{</span></span>
<span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">        printf</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;">fail to allocate memory</span><span style="--shiki-light:#EBCB8B;--shiki-dark:#EBCB8B;">\n</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">        free</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">fpHost_A</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span><span style="--shiki-light:#616E88;--shiki-dark:#616E88;"> // 释放先前CPU中制定的内存</span></span>
<span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">        free</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">fpHost_B</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">        exit</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">-</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;">1</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#616E88;--shiki-dark:#616E88;">     // 初始化主机中数据</span></span>
<span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">    srand</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;">666</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span><span style="--shiki-light:#616E88;--shiki-dark:#616E88;"> // 设置随机种子</span></span>
<span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">    initialData</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">fpHost_A</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> iElemCount</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#616E88;--shiki-dark:#616E88;">    // 主机复制到设备</span></span>
<span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">    ErrorCheck</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">cudaMemcpy</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">fpDevice_A</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">fpHost_A</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">stBytesCount</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">cudaMemcpyHostToDevice</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">),</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">__FILE__</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">__LINE__</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">    ErrorCheck</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">cudaMemcpy</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">fpDevice_B</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">fpHost_B</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">stBytesCount</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">cudaMemcpyHostToDevice</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">),</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">__FILE__</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">__LINE__</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">   </span></span>
<span class="line"><span style="--shiki-light:#616E88;--shiki-dark:#616E88;">    // 调用核函数</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">    const</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> dim3 </span><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">block</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;">32</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;">32</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span><span style="--shiki-light:#616E88;--shiki-dark:#616E88;"> // 设置block大小为2维32, 32</span></span>
<span class="line"><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">    dim3 </span><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">grid</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">((</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">N</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">-</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;">1</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">/</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;">32</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> +</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;"> 1</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,(</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">N</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">-</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;">1</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">/</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;">32</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> +</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;"> 1</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span><span style="--shiki-light:#616E88;--shiki-dark:#616E88;"> //向上取整，设置grid大小</span></span>
<span class="line"><span style="--shiki-light:#616E88;--shiki-dark:#616E88;">    // 预热</span></span>
<span class="line"><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">    transpose1</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">&lt;&lt;&lt;</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">grid</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> block</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">&gt;&gt;&gt;</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">fpDevice_A</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> fpDevice_B</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">N</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> </span></span>
<span class="line"><span style="--shiki-light:#616E88;--shiki-dark:#616E88;">    // 设置开始事件</span></span>
<span class="line"><span style="--shiki-light:#8FBCBB;--shiki-dark:#8FBCBB;">    cudaEvent_t</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> start</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> stop</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> </span></span>
<span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">    ErrorCheck</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">cudaEventCreate</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">&amp;</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">start</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">),</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> __FILE__</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> __LINE__</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">    ErrorCheck</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">cudaEventCreate</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">&amp;</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">stop</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">),</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> __FILE__</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> __LINE__</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">    ErrorCheck</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">cudaEventRecord</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">start</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">),</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> __FILE__</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> __LINE__</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">    cudaEventQuery</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">start</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">    transpose1</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">&lt;&lt;&lt;</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">grid</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> block</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">&gt;&gt;&gt;</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">fpDevice_A</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> fpDevice_B</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">N</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span><span style="--shiki-light:#616E88;--shiki-dark:#616E88;">  //调用核函数</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">    ErrorCheck</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">cudaEventRecord</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">stop</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">),</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> __FILE__</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> __LINE__</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">    ErrorCheck</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">cudaEventSynchronize</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">stop</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">),</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> __FILE__</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> __LINE__</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">    float</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> elapsed_time</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">    ErrorCheck</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">cudaEventElapsedTime</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">&amp;</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">elapsed_time</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> start</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> stop</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">),</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> __FILE__</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> __LINE__</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">    printf</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;">Time = %g ms.</span><span style="--shiki-light:#EBCB8B;--shiki-dark:#EBCB8B;">\n</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">&quot;</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> elapsed_time</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span><span style="--shiki-light:#616E88;--shiki-dark:#616E88;"> // 打印时间</span></span>
<span class="line"><span style="--shiki-light:#616E88;--shiki-dark:#616E88;">    // 将计算得到的数据从设备传给主机</span></span>
<span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">    ErrorCheck</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">cudaMemcpy</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">fpHost_B</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> fpDevice_B</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> stBytesCount</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> cudaMemcpyDeviceToHost</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">),</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">__FILE__</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">__LINE__</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#616E88;--shiki-dark:#616E88;">    // 释放主机与设备内存</span></span>
<span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">    free</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">fpHost_A</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">    free</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">fpHost_B</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">    ErrorCheck</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">cudaFree</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">fpDevice_A</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">),</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> __FILE__</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> __LINE__</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">    ErrorCheck</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">cudaFree</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">fpDevice_B</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">),</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> __FILE__</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> __LINE__</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">    ErrorCheck</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">cudaDeviceReset</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(),</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> __FILE__</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> __LINE__</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">    return</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;"> 0</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">}</span></span></code></pre></div><h2 id="共享内存" tabindex="-1">共享内存 <a class="header-anchor" href="#共享内存" aria-label="Permalink to &quot;共享内存&quot;">​</a></h2><h3 id="数组归约计算-例" tabindex="-1">数组归约计算(例) <a class="header-anchor" href="#数组归约计算-例" aria-label="Permalink to &quot;数组归约计算(例)&quot;">​</a></h3><p>数组规约计算即考虑有<mjx-container class="MathJax" jax="SVG" style="direction:ltr;position:relative;"><svg style="overflow:visible;min-height:1px;min-width:1px;vertical-align:0;" xmlns="http://www.w3.org/2000/svg" width="2.009ex" height="1.545ex" role="img" focusable="false" viewBox="0 -683 888 683" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z" style="stroke-width:3;"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top:0px;left:0px;clip:rect(1px, 1px, 1px, 1px);-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;padding:1px 0px 0px 0px;border:0px;display:block;width:auto;overflow:hidden;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math></mjx-assistive-mml></mjx-container>个元素的数组<mjx-container class="MathJax" jax="SVG" style="direction:ltr;position:relative;"><svg style="overflow:visible;min-height:1px;min-width:1px;vertical-align:-0.025ex;" xmlns="http://www.w3.org/2000/svg" width="1.294ex" height="1.025ex" role="img" focusable="false" viewBox="0 -442 572 453" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z" style="stroke-width:3;"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top:0px;left:0px;clip:rect(1px, 1px, 1px, 1px);-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;padding:1px 0px 0px 0px;border:0px;display:block;width:auto;overflow:hidden;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></mjx-assistive-mml></mjx-container>，计算其所有元素的和。在使用CPU计算时，如下代码，使用<code>-DUSE_DP</code>设置精度，其运行结果(具体代码见 github )</p><div class="language-zsh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">zsh</span><pre class="shiki shiki-themes nord nord vp-code"><code><span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">nvcc</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;"> -O3</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;"> reduce_cpu.cu</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;"> -o</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;"> reduce_cpu</span></span>
<span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">./reduce_cpu</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> </span></span>
<span class="line"><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">&gt;&gt;&gt; </span><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">Time</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;"> =</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;"> 129.05</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;"> ms.</span></span>
<span class="line"><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">&gt;&gt;&gt; </span><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">Ans:</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;"> 33554432.000000</span></span></code></pre></div><div class="language-zsh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">zsh</span><pre class="shiki shiki-themes nord nord vp-code"><code><span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">nvcc</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;"> -O3</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;"> -DUSE_DP</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;"> reduce_cpu.cu</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;"> -o</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;"> reduce_cpu</span></span>
<span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">./reduce_cpu</span></span>
<span class="line"><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">&gt;&gt;&gt; </span><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">Time</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;"> =</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;"> 69.4968</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;"> ms.</span></span>
<span class="line"><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">&gt;&gt;&gt; </span><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">Ans:</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;"> 123000000.110771</span></span></code></pre></div><p>CPU运算情况下，其单精度下的结果完全是错误的。在仅使用全局内存的情况下设计核函数</p><div class="language-zsh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">zsh</span><pre class="shiki shiki-themes nord nord vp-code"><code><span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">nvcc</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;"> -O3</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;">  reduce_cpu.cu</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;"> -o</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;"> reduce_gpu</span></span>
<span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">./reduce_gpu</span></span>
<span class="line"><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">&gt;&gt;&gt; </span><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">Time</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;"> =</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;"> 6.23568</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;"> ms.</span></span>
<span class="line"><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">&gt;&gt;&gt; </span><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">Sum:</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;"> 123633392.000000</span></span></code></pre></div><div class="language-zsh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">zsh</span><pre class="shiki shiki-themes nord nord vp-code"><code><span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">nvcc</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;"> -O3</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;"> -DUSE_DP</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;"> reduce_cpu.cu</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;"> -o</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;"> reduce_gpu</span></span>
<span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">./reduce_gpu</span></span>
<span class="line"><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">&gt;&gt;&gt; </span><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">Time</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;"> =</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;">  11.6348</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;"> ms.</span></span>
<span class="line"><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">&gt;&gt;&gt; </span><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">Ans:</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;"> 123000000.110771</span></span></code></pre></div><p>仅使用全局内存的GPU运算情况下，单精度时从第四位开始有错误，且计算速度约为CPU下的11倍。</p><div class="language-zsh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">zsh</span><pre class="shiki shiki-themes nord nord vp-code"><code><span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">nvcc</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;"> -O3</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;"> reduce_share.cu</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;"> -o</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;"> reduce_share</span></span>
<span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">./reduce_share</span></span>
<span class="line"><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">&gt;&gt;&gt; </span><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">Time</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;"> =</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;"> 5.87258</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;"> ms.</span></span>
<span class="line"><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">&gt;&gt;&gt; </span><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">Ans:</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;"> 123633392.000000</span></span></code></pre></div><div class="language-zsh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">zsh</span><pre class="shiki shiki-themes nord nord vp-code"><code><span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">nvcc</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;"> -O3</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;"> -DUSE_DP</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;"> reduce_share.cu</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;"> -o</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;"> reduce_share</span></span>
<span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">./reduce_share</span></span>
<span class="line"><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">&gt;&gt;&gt; </span><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">Time</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;"> =</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;"> 12.1048</span><span style="--shiki-light:#A3BE8C;--shiki-dark:#A3BE8C;"> ms.</span></span>
<span class="line"><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">&gt;&gt;&gt; </span><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">Ans:</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;"> 122999999.998770</span></span></code></pre></div><p>使用静态共享内存下GPU运算情况。考虑到全局内存的访问速度是所有内存中最低的，应减少对其使用。而寄存器是最高效的，但他只对线程可见，考虑到需要线程合作，采用线程块可见的共享内存。代码见github，一般来讲使用共享内存减少全局内存访问可以提高性能，但并不是绝对如此。但这至少带来了一个好处，现在我们的代码允许数组元素个数不是线程块大小的整数倍。</p><h3 id="矩阵转置-例-1" tabindex="-1">矩阵转置(例) <a class="header-anchor" href="#矩阵转置-例-1" aria-label="Permalink to &quot;矩阵转置(例)&quot;">​</a></h3><p>下面将之前的矩阵转置利用共享内存改写，</p><div class="language-c++ vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c++</span><pre class="shiki shiki-themes nord nord vp-code"><code><span class="line"><span style="--shiki-light:#616E88;--shiki-dark:#616E88;">// 设计核函数</span></span>
<span class="line"><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">__global__ </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">void</span><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;"> transpose1</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">const</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> float</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> *</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">A</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">float</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> *</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">B</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> const</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> int</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> N</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">){</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">    const</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> int</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> nx </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">=</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;"> threadIdx</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">x</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> +</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;"> blockDim</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">x</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">*</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">blockIdx</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">x</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">    const</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> int</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> ny </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">=</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;"> threadIdx</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">y</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> +</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;"> blockDim</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">y</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">*</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">blockIdx</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">y</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">    __shared__ </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">float</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;"> S</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">[</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;">32</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">][</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;">33</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">]</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">    </span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">    if</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;"> (</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">nx </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">&lt;</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> N </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">&amp;&amp;</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> ny </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">&lt;</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> N</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">){</span></span>
<span class="line"><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">        S</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">[</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">threadIdx</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">y</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">][</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">threadIdx</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">x</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">]</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> =</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;"> A</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">[</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">ny</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">*</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">N </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">+</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> nx</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">]</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span><span style="--shiki-light:#616E88;--shiki-dark:#616E88;"> // 合并访问，copy操作</span></span>
<span class="line"><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">    }</span></span>
<span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">    __syncthreads</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">()</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">    const</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> int</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> nx2 </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">=</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;"> threadIdx</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">y</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> +</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;"> blockDim</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">x</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">*</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">blockIdx</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">x</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">    const</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> int</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> ny2 </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">=</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;"> threadIdx</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">x</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> +</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;"> blockDim</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">y</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">*</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">blockIdx</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">y</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">    if</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;"> (</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">nx2 </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">&lt;</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> N </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">&amp;&amp;</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> ny2</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">&lt;</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> N</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">){</span></span>
<span class="line"><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">        B</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">[</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">nx2</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">*</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">N </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">+</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> ny2</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">]</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> =</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;"> S</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">[</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">threadIdx</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">x</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">][</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">threadIdx</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">y</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">]</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span><span style="--shiki-light:#616E88;--shiki-dark:#616E88;"> // 调换threadIdx.x 和 threadIdx.y 使得对B的访问也是合并的 </span></span>
<span class="line"><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">    }</span></span>
<span class="line"><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">}</span></span></code></pre></div><p>通过改写核函数，使得对A,B的访问都是合并的下面几行代码极为关键，仔细体会其正确性。</p><div class="language-c++ vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c++</span><pre class="shiki shiki-themes nord nord vp-code"><code><span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">const</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> int</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> nx2 </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">=</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;"> threadIdx</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">y</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> +</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;"> blockDim</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">x</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">*</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">blockIdx</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">x</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">const</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> int</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> ny2 </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">=</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;"> threadIdx</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">x</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> +</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;"> blockDim</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">y</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">*</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">blockIdx</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">y</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">if</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;"> (</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">nx2 </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">&lt;</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> N </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">&amp;&amp;</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> ny2</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">&lt;</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> N</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">){</span></span>
<span class="line"><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">    B</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">[</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">nx2</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">*</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">N </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">+</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> ny2</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">]</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> =</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;"> S</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">[</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">threadIdx</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">x</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">][</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">threadIdx</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">.</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">y</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">]</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span><span style="--shiki-light:#616E88;--shiki-dark:#616E88;"> // 调换threadIdx.x 和 threadIdx.y 使得对B的访问也是合并的 </span></span>
<span class="line"><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">}</span></span></code></pre></div><h3 id="bank冲突" tabindex="-1">bank冲突 <a class="header-anchor" href="#bank冲突" aria-label="Permalink to &quot;bank冲突&quot;">​</a></h3><p><code>bank</code>：为了获得高的内存带宽，共享内存在物理上被分为32(=wrap_size)同样宽度，可以被同时访问的内存bank，除了开普勒架构(8字节)，其他架构每个bank的宽度为4字节。<br> 共享内存数组是按照如下方式映射到内存bank中<br><img src="https://img-blog.csdnimg.cn/71b1a7e6d32f42b98b35c7071dfa9276.jpeg" alt=""> 简单说来，第0到31个数组元素在32个bank的第一层，第32到63个数组元素在32个bank的第二层...<br> 当同一个线程束内的多个线程不同时访问一个bank,此时由于不同bank可以同时访问，只需要发起一次访问请求，进行一次内存事务。但如果多个线程访问同一个bank中不同层数据，就会产生<strong>bank冲突</strong>，影响程序执行时间。<br> 在矩阵转置代码中，如果设置<code>__shared__ float S[32][32];</code>，则<code>B[nx2*N + ny2] = S[threadIdx.x][threadIdx.y]; </code>操作中，对于同一线程束中的线程(Idx.x连续)，这32个线程恰好访问同一个bank的32个数据，发生<strong>32路bank冲突</strong>。在改变共享内存的数组大小之后<code>__shared__ float S[32][33];</code>，同一个线程束中的32个线程(连续的32个threadIdx.x的值)将对应共享内存数组S中跨度为33的数据，如果第一个线程访问第一个bank的第一层；第二个线程会访问第二个bank的第二层，于是这32个线程将分别访问32个不同的bank中的数据，所以没有bank冲突。</p><h2 id="原子函数" tabindex="-1">原子函数 <a class="header-anchor" href="#原子函数" aria-label="Permalink to &quot;原子函数&quot;">​</a></h2><p>简而言之：正如其名，原子为基本组成单元，视为不可切分的一部分。使用原子函数意味者其函数执行读——改——写操作时不会被其他线程所干扰，能够防止数据被多线程读取改写所引发的错误。</p><h2 id="线程束基本函数与协作组" tabindex="-1">线程束基本函数与协作组 <a class="header-anchor" href="#线程束基本函数与协作组" aria-label="Permalink to &quot;线程束基本函数与协作组&quot;">​</a></h2><h3 id="单指令——多线程" tabindex="-1">单指令——多线程 <a class="header-anchor" href="#单指令——多线程" aria-label="Permalink to &quot;单指令——多线程&quot;">​</a></h3><p>单指令——多线程意味着一个线程束中的线程只能执行一个共同的指令或者闲置，这成为单指令——多线程。<br> 分支发散：当同一个线程束内部的线程执行条件语句的不同分支，此时造成性能下降，称之为分支发散。注意，如果一个分支不包含指令，那么即使发生分支发散也不会显著影响程序性能。</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>本节剩余内容不重要</p></div><p>伏特架构之前，一个线程束中的线程拥有同一个程序计数器，但各自有不同的寄存器状态，从而可以根据程序的逻辑判断选择不同的分支。而从伏特架构开始，引入了独立线程调度，每个线程拥有自己的程序计数器，提高了编程的灵活性，降低了移植CPU代码的难度。其代价一是增加了寄存器的负担，单个线程的程序计数器一般需要两个寄存器，也就是说，这使得SM中每个线程可用寄存器数量减少2，代价二，独立线程调度机制使得假设了线程束同步的代码变得不再安全。对于代价二，后面会介绍函数<code>__syncwarp()</code>线程束同步，或者生成PTX代码使用帕斯卡架构的线程调度机制： <code>-arch=compute_60 -code=sm_89</code>。</p><h3 id="线程束内的线程同步函数" tabindex="-1">线程束内的线程同步函数 <a class="header-anchor" href="#线程束内的线程同步函数" aria-label="Permalink to &quot;线程束内的线程同步函数&quot;">​</a></h3><h3 id="更多线程束内基本函数" tabindex="-1">更多线程束内基本函数 <a class="header-anchor" href="#更多线程束内基本函数" aria-label="Permalink to &quot;更多线程束内基本函数&quot;">​</a></h3><p>参考<a href="https://blog.csdn.net/AAAA202012/article/details/122292950" target="_blank" rel="noreferrer">CSDN</a> ，在伏特架构以后，使用这些函数必须使用带<code>_sync()</code>版本，即他们会有隐式的同步功能，自动处理读-写竞争的问题。</p><h3 id="协作组" tabindex="-1">协作组 <a class="header-anchor" href="#协作组" aria-label="Permalink to &quot;协作组&quot;">​</a></h3><p>使用协作组功能时需在相关源文件下加入<code>#include &lt;cooperative_groups.h&gt;</code>头文件，还要注意所有与协作组相关的数据类型和函数都定义在命名空间<code>cooperative_groups</code>下，<code>using namespace cooperative_groups</code>。<br> 协作组编程模型中最基本的类型是<code>thread_group</code>，该类型包含以下成员函数：</p><ul><li><code>void sync</code>: 同步组内所有线程</li><li><code>unsigned size</code>: 返回组内总的线程数目</li><li><code>unsigned thread_rank</code>:返回当前调用该函数的线程在组内的标号</li><li><code>bool is_valid</code>:若定义的组违反了CUDA限制，返回<code>False</code></li></ul><p>线程组类型有一个成为线程块<code>thread_block</code>的导出类型，该类型提供了两个额外函数</p><ul><li><code>dim3 group_index</code>: 相当于<code>blockIdx</code></li><li><code>dim3 thread_index</code>: 等价于<code>threadIdx</code></li></ul><p>另外，介绍函数<code>tiled_partition</code>，他可以将线程块分为设置大小的多个线程片，每一片构成一个线程组，但其<code>size</code>设置限制在2的整数倍不超过32的整数，例如<code>thread_group g32 = tiled_partition(this_thread_block(),32)</code>。<br> 特别的，若线程组的大小在编译期间就已知，可以使用如下模板</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes nord nord vp-code"><code><span class="line"><span>thread_block_tile&lt;32&gt; g32 = tiled_partition&lt;32&gt;(this_thread_block())</span></span></code></pre></div><p>这样定义的线程组称为线程块片，线程块片额外享有如下定义的函数</p><ul><li><code>unsigned __ballot_sync(int predicate)</code></li><li><code>int __all_sync(int predicate)</code></li><li><code>int __any_sync(int predicate)</code></li><li><code>T __shfl_sync(T,v,int srcLane)</code></li><li><code>T __up_sync(T,v,unsigned d)</code></li><li><code>T __down_sync(T,v,unsigned d)</code></li><li><code>T __xor_sync(T,v,int laneMask)</code></li></ul><p>相比于普通线程束内基本函数，第一少了第一个位置的mask参数，其默认组内所有线程都参与计算，第二是洗牌少了最后一个参数，因为该宽度就是线程块片的大小。</p><h2 id="cuda流" tabindex="-1">CUDA流 <a class="header-anchor" href="#cuda流" aria-label="Permalink to &quot;CUDA流&quot;">​</a></h2><h3 id="概述" tabindex="-1">概述 <a class="header-anchor" href="#概述" aria-label="Permalink to &quot;概述&quot;">​</a></h3><p>CUDA程序的并行层次主要有两个：核函数内部的并行，核函数外部的并行。在此之前，关注的都是内部的并行，外部并行主要指：</p><ul><li>核函数计算与数据传输之间的并行</li><li>主机计算与数据传输之间的并行</li><li>不同数据传输之间并行</li><li>核函数计算与主机计算间并行</li><li>不同核函数之间并行</li></ul><p>一个<code>CUDA stream</code>指的是由主机(或设备)发出的在一个设备中执行的CUDA操作，这里不考虑设备发出的流。任何CUDA操作都存在于某个CUDA流中，要么是默认流(空流)，要么是明确指定的非空流，非默认流使用如下方法在主机中定义、产生和销毁</p><div class="language-c++ vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c++</span><pre class="shiki shiki-themes nord nord vp-code"><code><span class="line"><span style="--shiki-light:#8FBCBB;--shiki-dark:#8FBCBB;">cudaStream_t</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> stream_1</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">cudaStreamCreate</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">&amp;</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">stream_1</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">cudaStreamDestroy</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">(</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">stream_1</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">)</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span></code></pre></div><p>为了检查一个CUDA流中的所有操作是否都已在设备内执行完成，CUDA运行时API提供</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes nord nord vp-code"><code><span class="line"><span>cudaError_t cudaStreamSynchronize(cudaStream_t stream); // 强制阻塞主机，等待CUDA流中的所有操作执行完毕</span></span>
<span class="line"><span>cudaError_t cudaStreamQuery(cudaStream_t stream); // 不会阻塞，仅查询</span></span></code></pre></div><h3 id="默认流中重叠主机和设备计算" tabindex="-1">默认流中重叠主机和设备计算 <a class="header-anchor" href="#默认流中重叠主机和设备计算" aria-label="Permalink to &quot;默认流中重叠主机和设备计算&quot;">​</a></h3><div class="language-c++ vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c++</span><pre class="shiki shiki-themes nord nord vp-code"><code><span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">cudaMemcpy</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">()</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">cudaMemcpy</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">()</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">sum</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">&lt;&lt;&lt;&gt;&gt;&gt;</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">()</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span><span style="--shiki-light:#616E88;--shiki-dark:#616E88;"> // 核函数</span></span>
<span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">cudaMemcpy</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">()</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span></code></pre></div><p>上述代码处于默认流中，从主机的角度看，在执行<code>cudaMemcpy</code>后会等待命令执行完毕，再往前走。但主机处理核函数时是异步的，即发出指令后立刻夺回控制权，但由于他们处于默认流中，下一个指令并不会立刻执行。但我们可以看到，主机发出核函数调用指令后会立刻发出下一个命令，利用这个原理，将主机计算放到核函数之后可提高性能，例如若<code>sum_cpu</code>与<code>sum_gpu</code>同等耗时。</p><div class="language-c++ vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c++</span><pre class="shiki shiki-themes nord nord vp-code"><code><span class="line"><span style="--shiki-light:#616E88;--shiki-dark:#616E88;">// 耗时短</span></span>
<span class="line"><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">sum_gpu</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">&lt;&lt;&lt;&gt;&gt;&gt;</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">()</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">sum_cpu</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">()</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#616E88;--shiki-dark:#616E88;">// 耗时长</span></span>
<span class="line"><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;">sum_cpu</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">()</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span>
<span class="line"><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">sum_gpu</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">&lt;&lt;&lt;&gt;&gt;&gt;</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">()</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">;</span></span></code></pre></div><h3 id="非默认cuda流中重叠多个核函数执行" tabindex="-1">非默认CUDA流中重叠多个核函数执行 <a class="header-anchor" href="#非默认cuda流中重叠多个核函数执行" aria-label="Permalink to &quot;非默认CUDA流中重叠多个核函数执行&quot;">​</a></h3><p>要实现多个核函数之间的并行必须使用多个CUDA流。在使用非默认流时，核函数执行配置如下：</p><div class="language-c++ vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c++</span><pre class="shiki shiki-themes nord nord vp-code"><code><span class="line"><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">kernel </span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">&lt;&lt;&lt;</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">N_grid</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">N_block</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">N_shared</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">stream_id</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">&gt;&gt;&gt;</span></span></code></pre></div><p>设置多流并发处理确实可以加速性能，但也要兼顾GPU的计算资源和不同架构GPU上能够并发执行的核函数个数的上限。</p><h3 id="非默认cuda流重叠核函数执行和数据传递" tabindex="-1">非默认CUDA流重叠核函数执行和数据传递 <a class="header-anchor" href="#非默认cuda流重叠核函数执行和数据传递" aria-label="Permalink to &quot;非默认CUDA流重叠核函数执行和数据传递&quot;">​</a></h3><p>要实现核函执行与数据传输并发，必须让两个操作处于不同的非默认流。且需要使用<code>cudaMem</code>异步版本(同步版本下，主机发送命令后需等待传输完成)，见下</p><div class="language-c++ vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c++</span><pre class="shiki shiki-themes nord nord vp-code"><code><span class="line"><span style="--shiki-light:#8FBCBB;--shiki-dark:#8FBCBB;">cudaError_t</span><span style="--shiki-light:#88C0D0;--shiki-dark:#88C0D0;"> cudaMemcpyAsync</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;"> 	(</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> 	void</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> *</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">  	dst</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">		const</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> void</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> *</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">  	src</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">		size_t</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">  	count</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span></span>
<span class="line"><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;">		enum</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;"> cudaMemcpyKind  	</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">kind</span><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">,</span></span>
<span class="line"><span style="--shiki-light:#8FBCBB;--shiki-dark:#8FBCBB;">		cudaStream_t</span><span style="--shiki-light:#D8DEE9;--shiki-dark:#D8DEE9;">  	stream</span><span style="--shiki-light:#81A1C1;--shiki-dark:#81A1C1;"> =</span><span style="--shiki-light:#B48EAD;--shiki-dark:#B48EAD;"> 0</span><span style="--shiki-light:#D8DEE9FF;--shiki-dark:#D8DEE9FF;">	 </span></span>
<span class="line"><span style="--shiki-light:#ECEFF4;--shiki-dark:#ECEFF4;">	)</span></span></code></pre></div><p>异步传输由GPU中的DMA直接实现，不需要主机参与。<br> 使用异步传输函数时，需要声明主机内存为不可分页内存。否则，主机内存为分页内存时，数据传输过程在使用GPU中DMA之前必须将数据从可分页内存移动到不可分页内存，从而必须与主机同步，主机无法在发出命令后立刻获得控制权，则无法实现不同CUDA流之间的并发。不可分页内存的分配可由以下<a href="https://developer.download.nvidia.cn/compute/DevZone/docs/html/C/doc/html/group__CUDART__MEMORY_g15a3871f15f8c38f5b7190946845758c.html#g15a3871f15f8c38f5b7190946845758c" target="_blank" rel="noreferrer">两个</a><a href="https://developer.download.nvidia.cn/compute/DevZone/docs/html/C/doc/html/group__CUDART__MEMORY_g9f93d9600f4504e0d637ceb43c91ebad.html#g9f93d9600f4504e0d637ceb43c91ebad" target="_blank" rel="noreferrer">函数</a>的任何一个实现</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes nord nord vp-code"><code><span class="line"><span>cudaError_t cudaMallocHost 	( 	void **  	ptr,</span></span>
<span class="line"><span>		size_t  	size	 </span></span>
<span class="line"><span>	) 	</span></span>
<span class="line"><span>cudaError_t cudaHostAlloc 	( 	void **  	pHost,</span></span>
<span class="line"><span>    size_t  	size,</span></span>
<span class="line"><span>    unsigned int  	flags	 </span></span>
<span class="line"><span>)</span></span></code></pre></div><p>现在考虑主机与设备间的数据传输(H2D, D2H)，例如在理想情况下，程序只需要经过三个过程， H2D,KER(设备计算),D2H，此时如果简单的将三个过程放入三个不同的流中，显然是不能得到加速，这是因为三个操作在逻辑上具有先后顺序。</p><mjx-container class="MathJax" jax="SVG" display="true" style="direction:ltr;display:block;text-align:center;margin:1em 0;position:relative;"><svg style="overflow:visible;min-height:1px;min-width:1px;vertical-align:-3.507ex;" xmlns="http://www.w3.org/2000/svg" width="35.528ex" height="8.145ex" role="img" focusable="false" viewBox="0 -2050 15703.6 3600" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mtable"><g data-mml-node="mtr" transform="translate(0,1300)"><g data-mml-node="mtd"></g><g data-mml-node="mtd"><g data-mml-node="mi"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(469,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(830,0)"><path data-c="1D45F" d="M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(1281,0)"><path data-c="1D452" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(1747,0)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(2276,0)"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z" style="stroke-width:3;"></path></g><g data-mml-node="mn" transform="translate(3154,0)"><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" style="stroke-width:3;"></path></g><g data-mml-node="mo" transform="translate(3931.8,0)"><path data-c="3A" d="M78 370Q78 394 95 412T138 430Q162 430 180 414T199 371Q199 346 182 328T139 310T96 327T78 370ZM78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(4487.6,0)"><path data-c="1D43B" d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 219 683Q260 681 355 681Q389 681 418 681T463 682T483 682Q499 682 499 672Q499 670 497 658Q492 641 487 638H485Q483 638 480 638T473 638T464 637T455 637Q416 636 405 634T387 623Q384 619 355 500Q348 474 340 442T328 395L324 380Q324 378 469 378H614L615 381Q615 384 646 504Q674 619 674 627T617 637Q594 637 587 639T580 648Q580 650 582 660Q586 677 588 679T604 682Q609 682 646 681T740 680Q802 680 835 681T871 682Q888 682 888 672Q888 645 876 638H874Q872 638 869 638T862 638T853 637T844 637Q805 636 794 634T776 623Q773 618 704 340T634 58Q634 51 638 51Q646 48 692 46H723Q729 38 729 37T726 19Q722 6 716 0H701Q664 2 567 2Q533 2 504 2T458 2T437 1Q420 1 420 10Q420 15 423 24Q428 43 433 45Q437 46 448 46H454Q481 46 514 49Q520 50 522 50T528 55T534 64T540 82T547 110T558 153Q565 181 569 198Q602 330 602 331T457 332H312L279 197Q245 63 245 58Q245 51 253 49T303 46H334Q340 38 340 37T337 19Q333 6 327 0H312Q275 2 178 2Q144 2 115 2T69 2T48 1Q31 1 31 10Q31 12 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z" style="stroke-width:3;"></path></g><g data-mml-node="mn" transform="translate(5375.6,0)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(5875.6,0)"><path data-c="1D437" d="M287 628Q287 635 230 637Q207 637 200 638T193 647Q193 655 197 667T204 682Q206 683 403 683Q570 682 590 682T630 676Q702 659 752 597T803 431Q803 275 696 151T444 3L430 1L236 0H125H72Q48 0 41 2T33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM703 469Q703 507 692 537T666 584T629 613T590 629T555 636Q553 636 541 636T512 636T479 637H436Q392 637 386 627Q384 623 313 339T242 52Q242 48 253 48T330 47Q335 47 349 47T373 46Q499 46 581 128Q617 164 640 212T683 339T703 469Z" style="stroke-width:3;"></path></g></g></g><g data-mml-node="mtr" transform="translate(0,0)"><g data-mml-node="mtd"></g><g data-mml-node="mtd"><g data-mml-node="mi"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(469,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(830,0)"><path data-c="1D45F" d="M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(1281,0)"><path data-c="1D452" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(1747,0)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(2276,0)"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z" style="stroke-width:3;"></path></g><g data-mml-node="mn" transform="translate(3154,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" style="stroke-width:3;"></path></g><g data-mml-node="mo" transform="translate(3931.8,0)"><path data-c="3A" d="M78 370Q78 394 95 412T138 430Q162 430 180 414T199 371Q199 346 182 328T139 310T96 327T78 370ZM78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z" style="stroke-width:3;"></path></g><g data-mml-node="mstyle" transform="translate(4209.8,0)"><g data-mml-node="mspace"></g></g><g data-mml-node="mstyle" transform="translate(6209.8,0)"><g data-mml-node="mspace"></g></g><g data-mml-node="mo" transform="translate(8209.8,0)"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(9487.6,0)"><path data-c="1D43E" d="M285 628Q285 635 228 637Q205 637 198 638T191 647Q191 649 193 661Q199 681 203 682Q205 683 214 683H219Q260 681 355 681Q389 681 418 681T463 682T483 682Q500 682 500 674Q500 669 497 660Q496 658 496 654T495 648T493 644T490 641T486 639T479 638T470 637T456 637Q416 636 405 634T387 623L306 305Q307 305 490 449T678 597Q692 611 692 620Q692 635 667 637Q651 637 651 648Q651 650 654 662T659 677Q662 682 676 682Q680 682 711 681T791 680Q814 680 839 681T869 682Q889 682 889 672Q889 650 881 642Q878 637 862 637Q787 632 726 586Q710 576 656 534T556 455L509 418L518 396Q527 374 546 329T581 244Q656 67 661 61Q663 59 666 57Q680 47 717 46H738Q744 38 744 37T741 19Q737 6 731 0H720Q680 3 625 3Q503 3 488 0H478Q472 6 472 9T474 27Q478 40 480 43T491 46H494Q544 46 544 71Q544 75 517 141T485 216L427 354L359 301L291 248L268 155Q245 63 245 58Q245 51 253 49T303 46H334Q340 37 340 35Q340 19 333 5Q328 0 317 0Q314 0 280 1T180 2Q118 2 85 2T49 1Q31 1 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(10376.6,0)"><path data-c="1D438" d="M492 213Q472 213 472 226Q472 230 477 250T482 285Q482 316 461 323T364 330H312Q311 328 277 192T243 52Q243 48 254 48T334 46Q428 46 458 48T518 61Q567 77 599 117T670 248Q680 270 683 272Q690 274 698 274Q718 274 718 261Q613 7 608 2Q605 0 322 0H133Q31 0 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q146 66 215 342T285 622Q285 629 281 629Q273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H757Q764 676 764 669Q764 664 751 557T737 447Q735 440 717 440H705Q698 445 698 453L701 476Q704 500 704 528Q704 558 697 578T678 609T643 625T596 632T532 634H485Q397 633 392 631Q388 629 386 622Q385 619 355 499T324 377Q347 376 372 376H398Q464 376 489 391T534 472Q538 488 540 490T557 493Q562 493 565 493T570 492T572 491T574 487T577 483L544 351Q511 218 508 216Q505 213 492 213Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(11140.6,0)"><path data-c="1D445" d="M230 637Q203 637 198 638T193 649Q193 676 204 682Q206 683 378 683Q550 682 564 680Q620 672 658 652T712 606T733 563T739 529Q739 484 710 445T643 385T576 351T538 338L545 333Q612 295 612 223Q612 212 607 162T602 80V71Q602 53 603 43T614 25T640 16Q668 16 686 38T712 85Q717 99 720 102T735 105Q755 105 755 93Q755 75 731 36Q693 -21 641 -21H632Q571 -21 531 4T487 82Q487 109 502 166T517 239Q517 290 474 313Q459 320 449 321T378 323H309L277 193Q244 61 244 59Q244 55 245 54T252 50T269 48T302 46H333Q339 38 339 37T336 19Q332 6 326 0H311Q275 2 180 2Q146 2 117 2T71 2T50 1Q33 1 33 10Q33 12 36 24Q41 43 46 45Q50 46 61 46H67Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628Q287 635 230 637ZM630 554Q630 586 609 608T523 636Q521 636 500 636T462 637H440Q393 637 386 627Q385 624 352 494T319 361Q319 360 388 360Q466 361 492 367Q556 377 592 426Q608 449 619 486T630 554Z" style="stroke-width:3;"></path></g></g></g><g data-mml-node="mtr" transform="translate(0,-1300)"><g data-mml-node="mtd"></g><g data-mml-node="mtd"><g data-mml-node="mi"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(469,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(830,0)"><path data-c="1D45F" d="M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(1281,0)"><path data-c="1D452" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(1747,0)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(2276,0)"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z" style="stroke-width:3;"></path></g><g data-mml-node="mn" transform="translate(3154,0)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z" style="stroke-width:3;"></path></g><g data-mml-node="mo" transform="translate(3931.8,0)"><path data-c="3A" d="M78 370Q78 394 95 412T138 430Q162 430 180 414T199 371Q199 346 182 328T139 310T96 327T78 370ZM78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z" style="stroke-width:3;"></path></g><g data-mml-node="mstyle" transform="translate(4209.8,0)"><g data-mml-node="mspace"></g></g><g data-mml-node="mstyle" transform="translate(6209.8,0)"><g data-mml-node="mspace"></g></g><g data-mml-node="mstyle" transform="translate(8209.8,0)"><g data-mml-node="mspace"></g></g><g data-mml-node="mstyle" transform="translate(10209.8,0)"><g data-mml-node="mspace"></g></g><g data-mml-node="mo" transform="translate(12209.8,0)"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(13487.6,0)"><path data-c="1D437" d="M287 628Q287 635 230 637Q207 637 200 638T193 647Q193 655 197 667T204 682Q206 683 403 683Q570 682 590 682T630 676Q702 659 752 597T803 431Q803 275 696 151T444 3L430 1L236 0H125H72Q48 0 41 2T33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM703 469Q703 507 692 537T666 584T629 613T590 629T555 636Q553 636 541 636T512 636T479 637H436Q392 637 386 627Q384 623 313 339T242 52Q242 48 253 48T330 47Q335 47 349 47T373 46Q499 46 581 128Q617 164 640 212T683 339T703 469Z" style="stroke-width:3;"></path></g><g data-mml-node="mn" transform="translate(14315.6,0)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(14815.6,0)"><path data-c="1D43B" d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 219 683Q260 681 355 681Q389 681 418 681T463 682T483 682Q499 682 499 672Q499 670 497 658Q492 641 487 638H485Q483 638 480 638T473 638T464 637T455 637Q416 636 405 634T387 623Q384 619 355 500Q348 474 340 442T328 395L324 380Q324 378 469 378H614L615 381Q615 384 646 504Q674 619 674 627T617 637Q594 637 587 639T580 648Q580 650 582 660Q586 677 588 679T604 682Q609 682 646 681T740 680Q802 680 835 681T871 682Q888 682 888 672Q888 645 876 638H874Q872 638 869 638T862 638T853 637T844 637Q805 636 794 634T776 623Q773 618 704 340T634 58Q634 51 638 51Q646 48 692 46H723Q729 38 729 37T726 19Q722 6 716 0H701Q664 2 567 2Q533 2 504 2T458 2T437 1Q420 1 420 10Q420 15 423 24Q428 43 433 45Q437 46 448 46H454Q481 46 514 49Q520 50 522 50T528 55T534 64T540 82T547 110T558 153Q565 181 569 198Q602 330 602 331T457 332H312L279 197Q245 63 245 58Q245 51 253 49T303 46H334Q340 38 340 37T337 19Q333 6 327 0H312Q275 2 178 2Q144 2 115 2T69 2T48 1Q31 1 31 10Q31 12 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z" style="stroke-width:3;"></path></g></g></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="block" style="top:0px;left:0px;clip:rect(1px, 1px, 1px, 1px);-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;padding:1px 0px 0px 0px;border:0px;display:block;overflow:hidden;width:100%;"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable displaystyle="true" columnalign="right left" columnspacing="0em" rowspacing="3pt"><mtr><mtd></mtd><mtd><mi>s</mi><mi>t</mi><mi>r</mi><mi>e</mi><mi>a</mi><mi>m</mi><mn>0</mn><mo>:</mo><mi>H</mi><mn>2</mn><mi>D</mi></mtd></mtr><mtr><mtd></mtd><mtd><mi>s</mi><mi>t</mi><mi>r</mi><mi>e</mi><mi>a</mi><mi>m</mi><mn>1</mn><mo>:</mo><mstyle scriptlevel="0"><mspace width="2em"></mspace></mstyle><mstyle scriptlevel="0"><mspace width="2em"></mspace></mstyle><mo stretchy="false">→</mo><mi>K</mi><mi>E</mi><mi>R</mi></mtd></mtr><mtr><mtd></mtd><mtd><mi>s</mi><mi>t</mi><mi>r</mi><mi>e</mi><mi>a</mi><mi>m</mi><mn>2</mn><mo>:</mo><mstyle scriptlevel="0"><mspace width="2em"></mspace></mstyle><mstyle scriptlevel="0"><mspace width="2em"></mspace></mstyle><mstyle scriptlevel="0"><mspace width="2em"></mspace></mstyle><mstyle scriptlevel="0"><mspace width="2em"></mspace></mstyle><mo stretchy="false">→</mo><mi>D</mi><mn>2</mn><mi>H</mi></mtd></mtr></mtable></math></mjx-assistive-mml></mjx-container><p>要获得性能上提升，必须创造出逻辑上并行执行的CUDA操作，一种方法是将每一步CUDA操作等分为若干份。</p><mjx-container class="MathJax" jax="SVG" display="true" style="direction:ltr;display:block;text-align:center;margin:1em 0;position:relative;"><svg style="overflow:visible;min-height:1px;min-width:1px;vertical-align:-2.036ex;" xmlns="http://www.w3.org/2000/svg" width="41.725ex" height="5.204ex" role="img" focusable="false" viewBox="0 -1400 18442.7 2300" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mtable"><g data-mml-node="mtr" transform="translate(0,650)"><g data-mml-node="mtd"></g><g data-mml-node="mtd"><g data-mml-node="mi"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(469,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(830,0)"><path data-c="1D45F" d="M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(1281,0)"><path data-c="1D452" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(1747,0)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(2276,0)"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z" style="stroke-width:3;"></path></g><g data-mml-node="mn" transform="translate(3154,0)"><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" style="stroke-width:3;"></path></g><g data-mml-node="mo" transform="translate(3931.8,0)"><path data-c="3A" d="M78 370Q78 394 95 412T138 430Q162 430 180 414T199 371Q199 346 182 328T139 310T96 327T78 370ZM78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(4487.6,0)"><path data-c="1D43B" d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 219 683Q260 681 355 681Q389 681 418 681T463 682T483 682Q499 682 499 672Q499 670 497 658Q492 641 487 638H485Q483 638 480 638T473 638T464 637T455 637Q416 636 405 634T387 623Q384 619 355 500Q348 474 340 442T328 395L324 380Q324 378 469 378H614L615 381Q615 384 646 504Q674 619 674 627T617 637Q594 637 587 639T580 648Q580 650 582 660Q586 677 588 679T604 682Q609 682 646 681T740 680Q802 680 835 681T871 682Q888 682 888 672Q888 645 876 638H874Q872 638 869 638T862 638T853 637T844 637Q805 636 794 634T776 623Q773 618 704 340T634 58Q634 51 638 51Q646 48 692 46H723Q729 38 729 37T726 19Q722 6 716 0H701Q664 2 567 2Q533 2 504 2T458 2T437 1Q420 1 420 10Q420 15 423 24Q428 43 433 45Q437 46 448 46H454Q481 46 514 49Q520 50 522 50T528 55T534 64T540 82T547 110T558 153Q565 181 569 198Q602 330 602 331T457 332H312L279 197Q245 63 245 58Q245 51 253 49T303 46H334Q340 38 340 37T337 19Q333 6 327 0H312Q275 2 178 2Q144 2 115 2T69 2T48 1Q31 1 31 10Q31 12 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z" style="stroke-width:3;"></path></g><g data-mml-node="mn" transform="translate(5375.6,0)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(5875.6,0)"><path data-c="1D437" d="M287 628Q287 635 230 637Q207 637 200 638T193 647Q193 655 197 667T204 682Q206 683 403 683Q570 682 590 682T630 676Q702 659 752 597T803 431Q803 275 696 151T444 3L430 1L236 0H125H72Q48 0 41 2T33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM703 469Q703 507 692 537T666 584T629 613T590 629T555 636Q553 636 541 636T512 636T479 637H436Q392 637 386 627Q384 623 313 339T242 52Q242 48 253 48T330 47Q335 47 349 47T373 46Q499 46 581 128Q617 164 640 212T683 339T703 469Z" style="stroke-width:3;"></path></g><g data-mml-node="mo" transform="translate(6981.3,0)"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(8259.1,0)"><path data-c="1D43E" d="M285 628Q285 635 228 637Q205 637 198 638T191 647Q191 649 193 661Q199 681 203 682Q205 683 214 683H219Q260 681 355 681Q389 681 418 681T463 682T483 682Q500 682 500 674Q500 669 497 660Q496 658 496 654T495 648T493 644T490 641T486 639T479 638T470 637T456 637Q416 636 405 634T387 623L306 305Q307 305 490 449T678 597Q692 611 692 620Q692 635 667 637Q651 637 651 648Q651 650 654 662T659 677Q662 682 676 682Q680 682 711 681T791 680Q814 680 839 681T869 682Q889 682 889 672Q889 650 881 642Q878 637 862 637Q787 632 726 586Q710 576 656 534T556 455L509 418L518 396Q527 374 546 329T581 244Q656 67 661 61Q663 59 666 57Q680 47 717 46H738Q744 38 744 37T741 19Q737 6 731 0H720Q680 3 625 3Q503 3 488 0H478Q472 6 472 9T474 27Q478 40 480 43T491 46H494Q544 46 544 71Q544 75 517 141T485 216L427 354L359 301L291 248L268 155Q245 63 245 58Q245 51 253 49T303 46H334Q340 37 340 35Q340 19 333 5Q328 0 317 0Q314 0 280 1T180 2Q118 2 85 2T49 1Q31 1 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(9148.1,0)"><path data-c="1D438" d="M492 213Q472 213 472 226Q472 230 477 250T482 285Q482 316 461 323T364 330H312Q311 328 277 192T243 52Q243 48 254 48T334 46Q428 46 458 48T518 61Q567 77 599 117T670 248Q680 270 683 272Q690 274 698 274Q718 274 718 261Q613 7 608 2Q605 0 322 0H133Q31 0 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q146 66 215 342T285 622Q285 629 281 629Q273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H757Q764 676 764 669Q764 664 751 557T737 447Q735 440 717 440H705Q698 445 698 453L701 476Q704 500 704 528Q704 558 697 578T678 609T643 625T596 632T532 634H485Q397 633 392 631Q388 629 386 622Q385 619 355 499T324 377Q347 376 372 376H398Q464 376 489 391T534 472Q538 488 540 490T557 493Q562 493 565 493T570 492T572 491T574 487T577 483L544 351Q511 218 508 216Q505 213 492 213Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(9912.1,0)"><path data-c="1D445" d="M230 637Q203 637 198 638T193 649Q193 676 204 682Q206 683 378 683Q550 682 564 680Q620 672 658 652T712 606T733 563T739 529Q739 484 710 445T643 385T576 351T538 338L545 333Q612 295 612 223Q612 212 607 162T602 80V71Q602 53 603 43T614 25T640 16Q668 16 686 38T712 85Q717 99 720 102T735 105Q755 105 755 93Q755 75 731 36Q693 -21 641 -21H632Q571 -21 531 4T487 82Q487 109 502 166T517 239Q517 290 474 313Q459 320 449 321T378 323H309L277 193Q244 61 244 59Q244 55 245 54T252 50T269 48T302 46H333Q339 38 339 37T336 19Q332 6 326 0H311Q275 2 180 2Q146 2 117 2T71 2T50 1Q33 1 33 10Q33 12 36 24Q41 43 46 45Q50 46 61 46H67Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628Q287 635 230 637ZM630 554Q630 586 609 608T523 636Q521 636 500 636T462 637H440Q393 637 386 627Q385 624 352 494T319 361Q319 360 388 360Q466 361 492 367Q556 377 592 426Q608 449 619 486T630 554Z" style="stroke-width:3;"></path></g><g data-mml-node="mo" transform="translate(10948.9,0)"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(12226.7,0)"><path data-c="1D437" d="M287 628Q287 635 230 637Q207 637 200 638T193 647Q193 655 197 667T204 682Q206 683 403 683Q570 682 590 682T630 676Q702 659 752 597T803 431Q803 275 696 151T444 3L430 1L236 0H125H72Q48 0 41 2T33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM703 469Q703 507 692 537T666 584T629 613T590 629T555 636Q553 636 541 636T512 636T479 637H436Q392 637 386 627Q384 623 313 339T242 52Q242 48 253 48T330 47Q335 47 349 47T373 46Q499 46 581 128Q617 164 640 212T683 339T703 469Z" style="stroke-width:3;"></path></g><g data-mml-node="mn" transform="translate(13054.7,0)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(13554.7,0)"><path data-c="1D43B" d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 219 683Q260 681 355 681Q389 681 418 681T463 682T483 682Q499 682 499 672Q499 670 497 658Q492 641 487 638H485Q483 638 480 638T473 638T464 637T455 637Q416 636 405 634T387 623Q384 619 355 500Q348 474 340 442T328 395L324 380Q324 378 469 378H614L615 381Q615 384 646 504Q674 619 674 627T617 637Q594 637 587 639T580 648Q580 650 582 660Q586 677 588 679T604 682Q609 682 646 681T740 680Q802 680 835 681T871 682Q888 682 888 672Q888 645 876 638H874Q872 638 869 638T862 638T853 637T844 637Q805 636 794 634T776 623Q773 618 704 340T634 58Q634 51 638 51Q646 48 692 46H723Q729 38 729 37T726 19Q722 6 716 0H701Q664 2 567 2Q533 2 504 2T458 2T437 1Q420 1 420 10Q420 15 423 24Q428 43 433 45Q437 46 448 46H454Q481 46 514 49Q520 50 522 50T528 55T534 64T540 82T547 110T558 153Q565 181 569 198Q602 330 602 331T457 332H312L279 197Q245 63 245 58Q245 51 253 49T303 46H334Q340 38 340 37T337 19Q333 6 327 0H312Q275 2 178 2Q144 2 115 2T69 2T48 1Q31 1 31 10Q31 12 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z" style="stroke-width:3;"></path></g></g></g><g data-mml-node="mtr" transform="translate(0,-650)"><g data-mml-node="mtd"></g><g data-mml-node="mtd"><g data-mml-node="mi"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(469,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(830,0)"><path data-c="1D45F" d="M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(1281,0)"><path data-c="1D452" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(1747,0)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(2276,0)"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z" style="stroke-width:3;"></path></g><g data-mml-node="mn" transform="translate(3154,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" style="stroke-width:3;"></path></g><g data-mml-node="mo" transform="translate(3931.8,0)"><path data-c="3A" d="M78 370Q78 394 95 412T138 430Q162 430 180 414T199 371Q199 346 182 328T139 310T96 327T78 370ZM78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z" style="stroke-width:3;"></path></g><g data-mml-node="mstyle" transform="translate(4209.8,0)"><g data-mml-node="mspace"></g></g><g data-mml-node="mstyle" transform="translate(6209.8,0)"><g data-mml-node="mspace"></g></g><g data-mml-node="mi" transform="translate(8487.6,0)"><path data-c="1D43B" d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 219 683Q260 681 355 681Q389 681 418 681T463 682T483 682Q499 682 499 672Q499 670 497 658Q492 641 487 638H485Q483 638 480 638T473 638T464 637T455 637Q416 636 405 634T387 623Q384 619 355 500Q348 474 340 442T328 395L324 380Q324 378 469 378H614L615 381Q615 384 646 504Q674 619 674 627T617 637Q594 637 587 639T580 648Q580 650 582 660Q586 677 588 679T604 682Q609 682 646 681T740 680Q802 680 835 681T871 682Q888 682 888 672Q888 645 876 638H874Q872 638 869 638T862 638T853 637T844 637Q805 636 794 634T776 623Q773 618 704 340T634 58Q634 51 638 51Q646 48 692 46H723Q729 38 729 37T726 19Q722 6 716 0H701Q664 2 567 2Q533 2 504 2T458 2T437 1Q420 1 420 10Q420 15 423 24Q428 43 433 45Q437 46 448 46H454Q481 46 514 49Q520 50 522 50T528 55T534 64T540 82T547 110T558 153Q565 181 569 198Q602 330 602 331T457 332H312L279 197Q245 63 245 58Q245 51 253 49T303 46H334Q340 38 340 37T337 19Q333 6 327 0H312Q275 2 178 2Q144 2 115 2T69 2T48 1Q31 1 31 10Q31 12 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z" style="stroke-width:3;"></path></g><g data-mml-node="mn" transform="translate(9375.6,0)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(9875.6,0)"><path data-c="1D437" d="M287 628Q287 635 230 637Q207 637 200 638T193 647Q193 655 197 667T204 682Q206 683 403 683Q570 682 590 682T630 676Q702 659 752 597T803 431Q803 275 696 151T444 3L430 1L236 0H125H72Q48 0 41 2T33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM703 469Q703 507 692 537T666 584T629 613T590 629T555 636Q553 636 541 636T512 636T479 637H436Q392 637 386 627Q384 623 313 339T242 52Q242 48 253 48T330 47Q335 47 349 47T373 46Q499 46 581 128Q617 164 640 212T683 339T703 469Z" style="stroke-width:3;"></path></g><g data-mml-node="mo" transform="translate(10981.3,0)"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(12259.1,0)"><path data-c="1D43E" d="M285 628Q285 635 228 637Q205 637 198 638T191 647Q191 649 193 661Q199 681 203 682Q205 683 214 683H219Q260 681 355 681Q389 681 418 681T463 682T483 682Q500 682 500 674Q500 669 497 660Q496 658 496 654T495 648T493 644T490 641T486 639T479 638T470 637T456 637Q416 636 405 634T387 623L306 305Q307 305 490 449T678 597Q692 611 692 620Q692 635 667 637Q651 637 651 648Q651 650 654 662T659 677Q662 682 676 682Q680 682 711 681T791 680Q814 680 839 681T869 682Q889 682 889 672Q889 650 881 642Q878 637 862 637Q787 632 726 586Q710 576 656 534T556 455L509 418L518 396Q527 374 546 329T581 244Q656 67 661 61Q663 59 666 57Q680 47 717 46H738Q744 38 744 37T741 19Q737 6 731 0H720Q680 3 625 3Q503 3 488 0H478Q472 6 472 9T474 27Q478 40 480 43T491 46H494Q544 46 544 71Q544 75 517 141T485 216L427 354L359 301L291 248L268 155Q245 63 245 58Q245 51 253 49T303 46H334Q340 37 340 35Q340 19 333 5Q328 0 317 0Q314 0 280 1T180 2Q118 2 85 2T49 1Q31 1 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(13148.1,0)"><path data-c="1D438" d="M492 213Q472 213 472 226Q472 230 477 250T482 285Q482 316 461 323T364 330H312Q311 328 277 192T243 52Q243 48 254 48T334 46Q428 46 458 48T518 61Q567 77 599 117T670 248Q680 270 683 272Q690 274 698 274Q718 274 718 261Q613 7 608 2Q605 0 322 0H133Q31 0 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q146 66 215 342T285 622Q285 629 281 629Q273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H757Q764 676 764 669Q764 664 751 557T737 447Q735 440 717 440H705Q698 445 698 453L701 476Q704 500 704 528Q704 558 697 578T678 609T643 625T596 632T532 634H485Q397 633 392 631Q388 629 386 622Q385 619 355 499T324 377Q347 376 372 376H398Q464 376 489 391T534 472Q538 488 540 490T557 493Q562 493 565 493T570 492T572 491T574 487T577 483L544 351Q511 218 508 216Q505 213 492 213Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(13912.1,0)"><path data-c="1D445" d="M230 637Q203 637 198 638T193 649Q193 676 204 682Q206 683 378 683Q550 682 564 680Q620 672 658 652T712 606T733 563T739 529Q739 484 710 445T643 385T576 351T538 338L545 333Q612 295 612 223Q612 212 607 162T602 80V71Q602 53 603 43T614 25T640 16Q668 16 686 38T712 85Q717 99 720 102T735 105Q755 105 755 93Q755 75 731 36Q693 -21 641 -21H632Q571 -21 531 4T487 82Q487 109 502 166T517 239Q517 290 474 313Q459 320 449 321T378 323H309L277 193Q244 61 244 59Q244 55 245 54T252 50T269 48T302 46H333Q339 38 339 37T336 19Q332 6 326 0H311Q275 2 180 2Q146 2 117 2T71 2T50 1Q33 1 33 10Q33 12 36 24Q41 43 46 45Q50 46 61 46H67Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628Q287 635 230 637ZM630 554Q630 586 609 608T523 636Q521 636 500 636T462 637H440Q393 637 386 627Q385 624 352 494T319 361Q319 360 388 360Q466 361 492 367Q556 377 592 426Q608 449 619 486T630 554Z" style="stroke-width:3;"></path></g><g data-mml-node="mo" transform="translate(14948.9,0)"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(16226.7,0)"><path data-c="1D437" d="M287 628Q287 635 230 637Q207 637 200 638T193 647Q193 655 197 667T204 682Q206 683 403 683Q570 682 590 682T630 676Q702 659 752 597T803 431Q803 275 696 151T444 3L430 1L236 0H125H72Q48 0 41 2T33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM703 469Q703 507 692 537T666 584T629 613T590 629T555 636Q553 636 541 636T512 636T479 637H436Q392 637 386 627Q384 623 313 339T242 52Q242 48 253 48T330 47Q335 47 349 47T373 46Q499 46 581 128Q617 164 640 212T683 339T703 469Z" style="stroke-width:3;"></path></g><g data-mml-node="mn" transform="translate(17054.7,0)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(17554.7,0)"><path data-c="1D43B" d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 219 683Q260 681 355 681Q389 681 418 681T463 682T483 682Q499 682 499 672Q499 670 497 658Q492 641 487 638H485Q483 638 480 638T473 638T464 637T455 637Q416 636 405 634T387 623Q384 619 355 500Q348 474 340 442T328 395L324 380Q324 378 469 378H614L615 381Q615 384 646 504Q674 619 674 627T617 637Q594 637 587 639T580 648Q580 650 582 660Q586 677 588 679T604 682Q609 682 646 681T740 680Q802 680 835 681T871 682Q888 682 888 672Q888 645 876 638H874Q872 638 869 638T862 638T853 637T844 637Q805 636 794 634T776 623Q773 618 704 340T634 58Q634 51 638 51Q646 48 692 46H723Q729 38 729 37T726 19Q722 6 716 0H701Q664 2 567 2Q533 2 504 2T458 2T437 1Q420 1 420 10Q420 15 423 24Q428 43 433 45Q437 46 448 46H454Q481 46 514 49Q520 50 522 50T528 55T534 64T540 82T547 110T558 153Q565 181 569 198Q602 330 602 331T457 332H312L279 197Q245 63 245 58Q245 51 253 49T303 46H334Q340 38 340 37T337 19Q333 6 327 0H312Q275 2 178 2Q144 2 115 2T69 2T48 1Q31 1 31 10Q31 12 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z" style="stroke-width:3;"></path></g></g></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="block" style="top:0px;left:0px;clip:rect(1px, 1px, 1px, 1px);-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;padding:1px 0px 0px 0px;border:0px;display:block;overflow:hidden;width:100%;"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable displaystyle="true" columnalign="right left" columnspacing="0em" rowspacing="3pt"><mtr><mtd></mtd><mtd><mi>s</mi><mi>t</mi><mi>r</mi><mi>e</mi><mi>a</mi><mi>m</mi><mn>0</mn><mo>:</mo><mi>H</mi><mn>2</mn><mi>D</mi><mo stretchy="false">→</mo><mi>K</mi><mi>E</mi><mi>R</mi><mo stretchy="false">→</mo><mi>D</mi><mn>2</mn><mi>H</mi></mtd></mtr><mtr><mtd></mtd><mtd><mi>s</mi><mi>t</mi><mi>r</mi><mi>e</mi><mi>a</mi><mi>m</mi><mn>1</mn><mo>:</mo><mstyle scriptlevel="0"><mspace width="2em"></mspace></mstyle><mstyle scriptlevel="0"><mspace width="2em"></mspace></mstyle><mi>H</mi><mn>2</mn><mi>D</mi><mo stretchy="false">→</mo><mi>K</mi><mi>E</mi><mi>R</mi><mo stretchy="false">→</mo><mi>D</mi><mn>2</mn><mi>H</mi></mtd></mtr></mtable></math></mjx-assistive-mml></mjx-container><p>性能提升<mjx-container class="MathJax" jax="SVG" style="direction:ltr;position:relative;"><svg style="overflow:visible;min-height:1px;min-width:1px;vertical-align:-0.781ex;" xmlns="http://www.w3.org/2000/svg" width="1.795ex" height="2.736ex" role="img" focusable="false" viewBox="0 -864.2 793.6 1209.2" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mfrac"><g data-mml-node="mn" transform="translate(220,394) scale(0.707)"><path data-c="33" d="M127 463Q100 463 85 480T69 524Q69 579 117 622T233 665Q268 665 277 664Q351 652 390 611T430 522Q430 470 396 421T302 350L299 348Q299 347 308 345T337 336T375 315Q457 262 457 175Q457 96 395 37T238 -22Q158 -22 100 21T42 130Q42 158 60 175T105 193Q133 193 151 175T169 130Q169 119 166 110T159 94T148 82T136 74T126 70T118 67L114 66Q165 21 238 21Q293 21 321 74Q338 107 338 175V195Q338 290 274 322Q259 328 213 329L171 330L168 332Q166 335 166 348Q166 366 174 366Q202 366 232 371Q266 376 294 413T322 525V533Q322 590 287 612Q265 626 240 626Q208 626 181 615T143 592T132 580H135Q138 579 143 578T153 573T165 566T175 555T183 540T186 520Q186 498 172 481T127 463Z" style="stroke-width:3;"></path></g><g data-mml-node="mn" transform="translate(220,-345) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z" style="stroke-width:3;"></path></g><rect width="553.6" height="60" x="120" y="220"></rect></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top:0px;left:0px;clip:rect(1px, 1px, 1px, 1px);-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;padding:1px 0px 0px 0px;border:0px;display:block;width:auto;overflow:hidden;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mn>3</mn><mn>2</mn></mfrac></math></mjx-assistive-mml></mjx-container>倍。</p><mjx-container class="MathJax" jax="SVG" display="true" style="direction:ltr;display:block;text-align:center;margin:1em 0;position:relative;"><svg style="overflow:visible;min-height:1px;min-width:1px;vertical-align:-3.507ex;" xmlns="http://www.w3.org/2000/svg" width="50.775ex" height="8.145ex" role="img" focusable="false" viewBox="0 -2050 22442.7 3600" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mtable"><g data-mml-node="mtr" transform="translate(0,1300)"><g data-mml-node="mtd"></g><g data-mml-node="mtd"><g data-mml-node="mi"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(469,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(830,0)"><path data-c="1D45F" d="M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(1281,0)"><path data-c="1D452" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(1747,0)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(2276,0)"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z" style="stroke-width:3;"></path></g><g data-mml-node="mn" transform="translate(3154,0)"><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" style="stroke-width:3;"></path></g><g data-mml-node="mo" transform="translate(3931.8,0)"><path data-c="3A" d="M78 370Q78 394 95 412T138 430Q162 430 180 414T199 371Q199 346 182 328T139 310T96 327T78 370ZM78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(4487.6,0)"><path data-c="1D43B" d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 219 683Q260 681 355 681Q389 681 418 681T463 682T483 682Q499 682 499 672Q499 670 497 658Q492 641 487 638H485Q483 638 480 638T473 638T464 637T455 637Q416 636 405 634T387 623Q384 619 355 500Q348 474 340 442T328 395L324 380Q324 378 469 378H614L615 381Q615 384 646 504Q674 619 674 627T617 637Q594 637 587 639T580 648Q580 650 582 660Q586 677 588 679T604 682Q609 682 646 681T740 680Q802 680 835 681T871 682Q888 682 888 672Q888 645 876 638H874Q872 638 869 638T862 638T853 637T844 637Q805 636 794 634T776 623Q773 618 704 340T634 58Q634 51 638 51Q646 48 692 46H723Q729 38 729 37T726 19Q722 6 716 0H701Q664 2 567 2Q533 2 504 2T458 2T437 1Q420 1 420 10Q420 15 423 24Q428 43 433 45Q437 46 448 46H454Q481 46 514 49Q520 50 522 50T528 55T534 64T540 82T547 110T558 153Q565 181 569 198Q602 330 602 331T457 332H312L279 197Q245 63 245 58Q245 51 253 49T303 46H334Q340 38 340 37T337 19Q333 6 327 0H312Q275 2 178 2Q144 2 115 2T69 2T48 1Q31 1 31 10Q31 12 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z" style="stroke-width:3;"></path></g><g data-mml-node="mn" transform="translate(5375.6,0)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(5875.6,0)"><path data-c="1D437" d="M287 628Q287 635 230 637Q207 637 200 638T193 647Q193 655 197 667T204 682Q206 683 403 683Q570 682 590 682T630 676Q702 659 752 597T803 431Q803 275 696 151T444 3L430 1L236 0H125H72Q48 0 41 2T33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM703 469Q703 507 692 537T666 584T629 613T590 629T555 636Q553 636 541 636T512 636T479 637H436Q392 637 386 627Q384 623 313 339T242 52Q242 48 253 48T330 47Q335 47 349 47T373 46Q499 46 581 128Q617 164 640 212T683 339T703 469Z" style="stroke-width:3;"></path></g><g data-mml-node="mo" transform="translate(6981.3,0)"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(8259.1,0)"><path data-c="1D43E" d="M285 628Q285 635 228 637Q205 637 198 638T191 647Q191 649 193 661Q199 681 203 682Q205 683 214 683H219Q260 681 355 681Q389 681 418 681T463 682T483 682Q500 682 500 674Q500 669 497 660Q496 658 496 654T495 648T493 644T490 641T486 639T479 638T470 637T456 637Q416 636 405 634T387 623L306 305Q307 305 490 449T678 597Q692 611 692 620Q692 635 667 637Q651 637 651 648Q651 650 654 662T659 677Q662 682 676 682Q680 682 711 681T791 680Q814 680 839 681T869 682Q889 682 889 672Q889 650 881 642Q878 637 862 637Q787 632 726 586Q710 576 656 534T556 455L509 418L518 396Q527 374 546 329T581 244Q656 67 661 61Q663 59 666 57Q680 47 717 46H738Q744 38 744 37T741 19Q737 6 731 0H720Q680 3 625 3Q503 3 488 0H478Q472 6 472 9T474 27Q478 40 480 43T491 46H494Q544 46 544 71Q544 75 517 141T485 216L427 354L359 301L291 248L268 155Q245 63 245 58Q245 51 253 49T303 46H334Q340 37 340 35Q340 19 333 5Q328 0 317 0Q314 0 280 1T180 2Q118 2 85 2T49 1Q31 1 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(9148.1,0)"><path data-c="1D438" d="M492 213Q472 213 472 226Q472 230 477 250T482 285Q482 316 461 323T364 330H312Q311 328 277 192T243 52Q243 48 254 48T334 46Q428 46 458 48T518 61Q567 77 599 117T670 248Q680 270 683 272Q690 274 698 274Q718 274 718 261Q613 7 608 2Q605 0 322 0H133Q31 0 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q146 66 215 342T285 622Q285 629 281 629Q273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H757Q764 676 764 669Q764 664 751 557T737 447Q735 440 717 440H705Q698 445 698 453L701 476Q704 500 704 528Q704 558 697 578T678 609T643 625T596 632T532 634H485Q397 633 392 631Q388 629 386 622Q385 619 355 499T324 377Q347 376 372 376H398Q464 376 489 391T534 472Q538 488 540 490T557 493Q562 493 565 493T570 492T572 491T574 487T577 483L544 351Q511 218 508 216Q505 213 492 213Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(9912.1,0)"><path data-c="1D445" d="M230 637Q203 637 198 638T193 649Q193 676 204 682Q206 683 378 683Q550 682 564 680Q620 672 658 652T712 606T733 563T739 529Q739 484 710 445T643 385T576 351T538 338L545 333Q612 295 612 223Q612 212 607 162T602 80V71Q602 53 603 43T614 25T640 16Q668 16 686 38T712 85Q717 99 720 102T735 105Q755 105 755 93Q755 75 731 36Q693 -21 641 -21H632Q571 -21 531 4T487 82Q487 109 502 166T517 239Q517 290 474 313Q459 320 449 321T378 323H309L277 193Q244 61 244 59Q244 55 245 54T252 50T269 48T302 46H333Q339 38 339 37T336 19Q332 6 326 0H311Q275 2 180 2Q146 2 117 2T71 2T50 1Q33 1 33 10Q33 12 36 24Q41 43 46 45Q50 46 61 46H67Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628Q287 635 230 637ZM630 554Q630 586 609 608T523 636Q521 636 500 636T462 637H440Q393 637 386 627Q385 624 352 494T319 361Q319 360 388 360Q466 361 492 367Q556 377 592 426Q608 449 619 486T630 554Z" style="stroke-width:3;"></path></g><g data-mml-node="mo" transform="translate(10948.9,0)"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(12226.7,0)"><path data-c="1D437" d="M287 628Q287 635 230 637Q207 637 200 638T193 647Q193 655 197 667T204 682Q206 683 403 683Q570 682 590 682T630 676Q702 659 752 597T803 431Q803 275 696 151T444 3L430 1L236 0H125H72Q48 0 41 2T33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM703 469Q703 507 692 537T666 584T629 613T590 629T555 636Q553 636 541 636T512 636T479 637H436Q392 637 386 627Q384 623 313 339T242 52Q242 48 253 48T330 47Q335 47 349 47T373 46Q499 46 581 128Q617 164 640 212T683 339T703 469Z" style="stroke-width:3;"></path></g><g data-mml-node="mn" transform="translate(13054.7,0)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(13554.7,0)"><path data-c="1D43B" d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 219 683Q260 681 355 681Q389 681 418 681T463 682T483 682Q499 682 499 672Q499 670 497 658Q492 641 487 638H485Q483 638 480 638T473 638T464 637T455 637Q416 636 405 634T387 623Q384 619 355 500Q348 474 340 442T328 395L324 380Q324 378 469 378H614L615 381Q615 384 646 504Q674 619 674 627T617 637Q594 637 587 639T580 648Q580 650 582 660Q586 677 588 679T604 682Q609 682 646 681T740 680Q802 680 835 681T871 682Q888 682 888 672Q888 645 876 638H874Q872 638 869 638T862 638T853 637T844 637Q805 636 794 634T776 623Q773 618 704 340T634 58Q634 51 638 51Q646 48 692 46H723Q729 38 729 37T726 19Q722 6 716 0H701Q664 2 567 2Q533 2 504 2T458 2T437 1Q420 1 420 10Q420 15 423 24Q428 43 433 45Q437 46 448 46H454Q481 46 514 49Q520 50 522 50T528 55T534 64T540 82T547 110T558 153Q565 181 569 198Q602 330 602 331T457 332H312L279 197Q245 63 245 58Q245 51 253 49T303 46H334Q340 38 340 37T337 19Q333 6 327 0H312Q275 2 178 2Q144 2 115 2T69 2T48 1Q31 1 31 10Q31 12 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z" style="stroke-width:3;"></path></g></g></g><g data-mml-node="mtr" transform="translate(0,0)"><g data-mml-node="mtd"></g><g data-mml-node="mtd"><g data-mml-node="mi"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(469,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(830,0)"><path data-c="1D45F" d="M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(1281,0)"><path data-c="1D452" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(1747,0)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(2276,0)"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z" style="stroke-width:3;"></path></g><g data-mml-node="mn" transform="translate(3154,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" style="stroke-width:3;"></path></g><g data-mml-node="mo" transform="translate(3931.8,0)"><path data-c="3A" d="M78 370Q78 394 95 412T138 430Q162 430 180 414T199 371Q199 346 182 328T139 310T96 327T78 370ZM78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z" style="stroke-width:3;"></path></g><g data-mml-node="mstyle" transform="translate(4209.8,0)"><g data-mml-node="mspace"></g></g><g data-mml-node="mstyle" transform="translate(6209.8,0)"><g data-mml-node="mspace"></g></g><g data-mml-node="mi" transform="translate(8487.6,0)"><path data-c="1D43B" d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 219 683Q260 681 355 681Q389 681 418 681T463 682T483 682Q499 682 499 672Q499 670 497 658Q492 641 487 638H485Q483 638 480 638T473 638T464 637T455 637Q416 636 405 634T387 623Q384 619 355 500Q348 474 340 442T328 395L324 380Q324 378 469 378H614L615 381Q615 384 646 504Q674 619 674 627T617 637Q594 637 587 639T580 648Q580 650 582 660Q586 677 588 679T604 682Q609 682 646 681T740 680Q802 680 835 681T871 682Q888 682 888 672Q888 645 876 638H874Q872 638 869 638T862 638T853 637T844 637Q805 636 794 634T776 623Q773 618 704 340T634 58Q634 51 638 51Q646 48 692 46H723Q729 38 729 37T726 19Q722 6 716 0H701Q664 2 567 2Q533 2 504 2T458 2T437 1Q420 1 420 10Q420 15 423 24Q428 43 433 45Q437 46 448 46H454Q481 46 514 49Q520 50 522 50T528 55T534 64T540 82T547 110T558 153Q565 181 569 198Q602 330 602 331T457 332H312L279 197Q245 63 245 58Q245 51 253 49T303 46H334Q340 38 340 37T337 19Q333 6 327 0H312Q275 2 178 2Q144 2 115 2T69 2T48 1Q31 1 31 10Q31 12 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z" style="stroke-width:3;"></path></g><g data-mml-node="mn" transform="translate(9375.6,0)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(9875.6,0)"><path data-c="1D437" d="M287 628Q287 635 230 637Q207 637 200 638T193 647Q193 655 197 667T204 682Q206 683 403 683Q570 682 590 682T630 676Q702 659 752 597T803 431Q803 275 696 151T444 3L430 1L236 0H125H72Q48 0 41 2T33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM703 469Q703 507 692 537T666 584T629 613T590 629T555 636Q553 636 541 636T512 636T479 637H436Q392 637 386 627Q384 623 313 339T242 52Q242 48 253 48T330 47Q335 47 349 47T373 46Q499 46 581 128Q617 164 640 212T683 339T703 469Z" style="stroke-width:3;"></path></g><g data-mml-node="mo" transform="translate(10981.3,0)"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(12259.1,0)"><path data-c="1D43E" d="M285 628Q285 635 228 637Q205 637 198 638T191 647Q191 649 193 661Q199 681 203 682Q205 683 214 683H219Q260 681 355 681Q389 681 418 681T463 682T483 682Q500 682 500 674Q500 669 497 660Q496 658 496 654T495 648T493 644T490 641T486 639T479 638T470 637T456 637Q416 636 405 634T387 623L306 305Q307 305 490 449T678 597Q692 611 692 620Q692 635 667 637Q651 637 651 648Q651 650 654 662T659 677Q662 682 676 682Q680 682 711 681T791 680Q814 680 839 681T869 682Q889 682 889 672Q889 650 881 642Q878 637 862 637Q787 632 726 586Q710 576 656 534T556 455L509 418L518 396Q527 374 546 329T581 244Q656 67 661 61Q663 59 666 57Q680 47 717 46H738Q744 38 744 37T741 19Q737 6 731 0H720Q680 3 625 3Q503 3 488 0H478Q472 6 472 9T474 27Q478 40 480 43T491 46H494Q544 46 544 71Q544 75 517 141T485 216L427 354L359 301L291 248L268 155Q245 63 245 58Q245 51 253 49T303 46H334Q340 37 340 35Q340 19 333 5Q328 0 317 0Q314 0 280 1T180 2Q118 2 85 2T49 1Q31 1 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(13148.1,0)"><path data-c="1D438" d="M492 213Q472 213 472 226Q472 230 477 250T482 285Q482 316 461 323T364 330H312Q311 328 277 192T243 52Q243 48 254 48T334 46Q428 46 458 48T518 61Q567 77 599 117T670 248Q680 270 683 272Q690 274 698 274Q718 274 718 261Q613 7 608 2Q605 0 322 0H133Q31 0 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q146 66 215 342T285 622Q285 629 281 629Q273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H757Q764 676 764 669Q764 664 751 557T737 447Q735 440 717 440H705Q698 445 698 453L701 476Q704 500 704 528Q704 558 697 578T678 609T643 625T596 632T532 634H485Q397 633 392 631Q388 629 386 622Q385 619 355 499T324 377Q347 376 372 376H398Q464 376 489 391T534 472Q538 488 540 490T557 493Q562 493 565 493T570 492T572 491T574 487T577 483L544 351Q511 218 508 216Q505 213 492 213Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(13912.1,0)"><path data-c="1D445" d="M230 637Q203 637 198 638T193 649Q193 676 204 682Q206 683 378 683Q550 682 564 680Q620 672 658 652T712 606T733 563T739 529Q739 484 710 445T643 385T576 351T538 338L545 333Q612 295 612 223Q612 212 607 162T602 80V71Q602 53 603 43T614 25T640 16Q668 16 686 38T712 85Q717 99 720 102T735 105Q755 105 755 93Q755 75 731 36Q693 -21 641 -21H632Q571 -21 531 4T487 82Q487 109 502 166T517 239Q517 290 474 313Q459 320 449 321T378 323H309L277 193Q244 61 244 59Q244 55 245 54T252 50T269 48T302 46H333Q339 38 339 37T336 19Q332 6 326 0H311Q275 2 180 2Q146 2 117 2T71 2T50 1Q33 1 33 10Q33 12 36 24Q41 43 46 45Q50 46 61 46H67Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628Q287 635 230 637ZM630 554Q630 586 609 608T523 636Q521 636 500 636T462 637H440Q393 637 386 627Q385 624 352 494T319 361Q319 360 388 360Q466 361 492 367Q556 377 592 426Q608 449 619 486T630 554Z" style="stroke-width:3;"></path></g><g data-mml-node="mo" transform="translate(14948.9,0)"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(16226.7,0)"><path data-c="1D437" d="M287 628Q287 635 230 637Q207 637 200 638T193 647Q193 655 197 667T204 682Q206 683 403 683Q570 682 590 682T630 676Q702 659 752 597T803 431Q803 275 696 151T444 3L430 1L236 0H125H72Q48 0 41 2T33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM703 469Q703 507 692 537T666 584T629 613T590 629T555 636Q553 636 541 636T512 636T479 637H436Q392 637 386 627Q384 623 313 339T242 52Q242 48 253 48T330 47Q335 47 349 47T373 46Q499 46 581 128Q617 164 640 212T683 339T703 469Z" style="stroke-width:3;"></path></g><g data-mml-node="mn" transform="translate(17054.7,0)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(17554.7,0)"><path data-c="1D43B" d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 219 683Q260 681 355 681Q389 681 418 681T463 682T483 682Q499 682 499 672Q499 670 497 658Q492 641 487 638H485Q483 638 480 638T473 638T464 637T455 637Q416 636 405 634T387 623Q384 619 355 500Q348 474 340 442T328 395L324 380Q324 378 469 378H614L615 381Q615 384 646 504Q674 619 674 627T617 637Q594 637 587 639T580 648Q580 650 582 660Q586 677 588 679T604 682Q609 682 646 681T740 680Q802 680 835 681T871 682Q888 682 888 672Q888 645 876 638H874Q872 638 869 638T862 638T853 637T844 637Q805 636 794 634T776 623Q773 618 704 340T634 58Q634 51 638 51Q646 48 692 46H723Q729 38 729 37T726 19Q722 6 716 0H701Q664 2 567 2Q533 2 504 2T458 2T437 1Q420 1 420 10Q420 15 423 24Q428 43 433 45Q437 46 448 46H454Q481 46 514 49Q520 50 522 50T528 55T534 64T540 82T547 110T558 153Q565 181 569 198Q602 330 602 331T457 332H312L279 197Q245 63 245 58Q245 51 253 49T303 46H334Q340 38 340 37T337 19Q333 6 327 0H312Q275 2 178 2Q144 2 115 2T69 2T48 1Q31 1 31 10Q31 12 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z" style="stroke-width:3;"></path></g></g></g><g data-mml-node="mtr" transform="translate(0,-1300)"><g data-mml-node="mtd"></g><g data-mml-node="mtd"><g data-mml-node="mi"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(469,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(830,0)"><path data-c="1D45F" d="M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(1281,0)"><path data-c="1D452" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(1747,0)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(2276,0)"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z" style="stroke-width:3;"></path></g><g data-mml-node="mn" transform="translate(3154,0)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z" style="stroke-width:3;"></path></g><g data-mml-node="mo" transform="translate(3931.8,0)"><path data-c="3A" d="M78 370Q78 394 95 412T138 430Q162 430 180 414T199 371Q199 346 182 328T139 310T96 327T78 370ZM78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z" style="stroke-width:3;"></path></g><g data-mml-node="mstyle" transform="translate(4209.8,0)"><g data-mml-node="mspace"></g></g><g data-mml-node="mstyle" transform="translate(6209.8,0)"><g data-mml-node="mspace"></g></g><g data-mml-node="mstyle" transform="translate(8209.8,0)"><g data-mml-node="mspace"></g></g><g data-mml-node="mstyle" transform="translate(10209.8,0)"><g data-mml-node="mspace"></g></g><g data-mml-node="mi" transform="translate(12487.6,0)"><path data-c="1D43B" d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 219 683Q260 681 355 681Q389 681 418 681T463 682T483 682Q499 682 499 672Q499 670 497 658Q492 641 487 638H485Q483 638 480 638T473 638T464 637T455 637Q416 636 405 634T387 623Q384 619 355 500Q348 474 340 442T328 395L324 380Q324 378 469 378H614L615 381Q615 384 646 504Q674 619 674 627T617 637Q594 637 587 639T580 648Q580 650 582 660Q586 677 588 679T604 682Q609 682 646 681T740 680Q802 680 835 681T871 682Q888 682 888 672Q888 645 876 638H874Q872 638 869 638T862 638T853 637T844 637Q805 636 794 634T776 623Q773 618 704 340T634 58Q634 51 638 51Q646 48 692 46H723Q729 38 729 37T726 19Q722 6 716 0H701Q664 2 567 2Q533 2 504 2T458 2T437 1Q420 1 420 10Q420 15 423 24Q428 43 433 45Q437 46 448 46H454Q481 46 514 49Q520 50 522 50T528 55T534 64T540 82T547 110T558 153Q565 181 569 198Q602 330 602 331T457 332H312L279 197Q245 63 245 58Q245 51 253 49T303 46H334Q340 38 340 37T337 19Q333 6 327 0H312Q275 2 178 2Q144 2 115 2T69 2T48 1Q31 1 31 10Q31 12 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z" style="stroke-width:3;"></path></g><g data-mml-node="mn" transform="translate(13375.6,0)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(13875.6,0)"><path data-c="1D437" d="M287 628Q287 635 230 637Q207 637 200 638T193 647Q193 655 197 667T204 682Q206 683 403 683Q570 682 590 682T630 676Q702 659 752 597T803 431Q803 275 696 151T444 3L430 1L236 0H125H72Q48 0 41 2T33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM703 469Q703 507 692 537T666 584T629 613T590 629T555 636Q553 636 541 636T512 636T479 637H436Q392 637 386 627Q384 623 313 339T242 52Q242 48 253 48T330 47Q335 47 349 47T373 46Q499 46 581 128Q617 164 640 212T683 339T703 469Z" style="stroke-width:3;"></path></g><g data-mml-node="mo" transform="translate(14981.3,0)"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(16259.1,0)"><path data-c="1D43E" d="M285 628Q285 635 228 637Q205 637 198 638T191 647Q191 649 193 661Q199 681 203 682Q205 683 214 683H219Q260 681 355 681Q389 681 418 681T463 682T483 682Q500 682 500 674Q500 669 497 660Q496 658 496 654T495 648T493 644T490 641T486 639T479 638T470 637T456 637Q416 636 405 634T387 623L306 305Q307 305 490 449T678 597Q692 611 692 620Q692 635 667 637Q651 637 651 648Q651 650 654 662T659 677Q662 682 676 682Q680 682 711 681T791 680Q814 680 839 681T869 682Q889 682 889 672Q889 650 881 642Q878 637 862 637Q787 632 726 586Q710 576 656 534T556 455L509 418L518 396Q527 374 546 329T581 244Q656 67 661 61Q663 59 666 57Q680 47 717 46H738Q744 38 744 37T741 19Q737 6 731 0H720Q680 3 625 3Q503 3 488 0H478Q472 6 472 9T474 27Q478 40 480 43T491 46H494Q544 46 544 71Q544 75 517 141T485 216L427 354L359 301L291 248L268 155Q245 63 245 58Q245 51 253 49T303 46H334Q340 37 340 35Q340 19 333 5Q328 0 317 0Q314 0 280 1T180 2Q118 2 85 2T49 1Q31 1 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(17148.1,0)"><path data-c="1D438" d="M492 213Q472 213 472 226Q472 230 477 250T482 285Q482 316 461 323T364 330H312Q311 328 277 192T243 52Q243 48 254 48T334 46Q428 46 458 48T518 61Q567 77 599 117T670 248Q680 270 683 272Q690 274 698 274Q718 274 718 261Q613 7 608 2Q605 0 322 0H133Q31 0 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q146 66 215 342T285 622Q285 629 281 629Q273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H757Q764 676 764 669Q764 664 751 557T737 447Q735 440 717 440H705Q698 445 698 453L701 476Q704 500 704 528Q704 558 697 578T678 609T643 625T596 632T532 634H485Q397 633 392 631Q388 629 386 622Q385 619 355 499T324 377Q347 376 372 376H398Q464 376 489 391T534 472Q538 488 540 490T557 493Q562 493 565 493T570 492T572 491T574 487T577 483L544 351Q511 218 508 216Q505 213 492 213Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(17912.1,0)"><path data-c="1D445" d="M230 637Q203 637 198 638T193 649Q193 676 204 682Q206 683 378 683Q550 682 564 680Q620 672 658 652T712 606T733 563T739 529Q739 484 710 445T643 385T576 351T538 338L545 333Q612 295 612 223Q612 212 607 162T602 80V71Q602 53 603 43T614 25T640 16Q668 16 686 38T712 85Q717 99 720 102T735 105Q755 105 755 93Q755 75 731 36Q693 -21 641 -21H632Q571 -21 531 4T487 82Q487 109 502 166T517 239Q517 290 474 313Q459 320 449 321T378 323H309L277 193Q244 61 244 59Q244 55 245 54T252 50T269 48T302 46H333Q339 38 339 37T336 19Q332 6 326 0H311Q275 2 180 2Q146 2 117 2T71 2T50 1Q33 1 33 10Q33 12 36 24Q41 43 46 45Q50 46 61 46H67Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628Q287 635 230 637ZM630 554Q630 586 609 608T523 636Q521 636 500 636T462 637H440Q393 637 386 627Q385 624 352 494T319 361Q319 360 388 360Q466 361 492 367Q556 377 592 426Q608 449 619 486T630 554Z" style="stroke-width:3;"></path></g><g data-mml-node="mo" transform="translate(18948.9,0)"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(20226.7,0)"><path data-c="1D437" d="M287 628Q287 635 230 637Q207 637 200 638T193 647Q193 655 197 667T204 682Q206 683 403 683Q570 682 590 682T630 676Q702 659 752 597T803 431Q803 275 696 151T444 3L430 1L236 0H125H72Q48 0 41 2T33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM703 469Q703 507 692 537T666 584T629 613T590 629T555 636Q553 636 541 636T512 636T479 637H436Q392 637 386 627Q384 623 313 339T242 52Q242 48 253 48T330 47Q335 47 349 47T373 46Q499 46 581 128Q617 164 640 212T683 339T703 469Z" style="stroke-width:3;"></path></g><g data-mml-node="mn" transform="translate(21054.7,0)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(21554.7,0)"><path data-c="1D43B" d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 219 683Q260 681 355 681Q389 681 418 681T463 682T483 682Q499 682 499 672Q499 670 497 658Q492 641 487 638H485Q483 638 480 638T473 638T464 637T455 637Q416 636 405 634T387 623Q384 619 355 500Q348 474 340 442T328 395L324 380Q324 378 469 378H614L615 381Q615 384 646 504Q674 619 674 627T617 637Q594 637 587 639T580 648Q580 650 582 660Q586 677 588 679T604 682Q609 682 646 681T740 680Q802 680 835 681T871 682Q888 682 888 672Q888 645 876 638H874Q872 638 869 638T862 638T853 637T844 637Q805 636 794 634T776 623Q773 618 704 340T634 58Q634 51 638 51Q646 48 692 46H723Q729 38 729 37T726 19Q722 6 716 0H701Q664 2 567 2Q533 2 504 2T458 2T437 1Q420 1 420 10Q420 15 423 24Q428 43 433 45Q437 46 448 46H454Q481 46 514 49Q520 50 522 50T528 55T534 64T540 82T547 110T558 153Q565 181 569 198Q602 330 602 331T457 332H312L279 197Q245 63 245 58Q245 51 253 49T303 46H334Q340 38 340 37T337 19Q333 6 327 0H312Q275 2 178 2Q144 2 115 2T69 2T48 1Q31 1 31 10Q31 12 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z" style="stroke-width:3;"></path></g></g></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="block" style="top:0px;left:0px;clip:rect(1px, 1px, 1px, 1px);-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;padding:1px 0px 0px 0px;border:0px;display:block;overflow:hidden;width:100%;"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable displaystyle="true" columnalign="right left" columnspacing="0em" rowspacing="3pt"><mtr><mtd></mtd><mtd><mi>s</mi><mi>t</mi><mi>r</mi><mi>e</mi><mi>a</mi><mi>m</mi><mn>0</mn><mo>:</mo><mi>H</mi><mn>2</mn><mi>D</mi><mo stretchy="false">→</mo><mi>K</mi><mi>E</mi><mi>R</mi><mo stretchy="false">→</mo><mi>D</mi><mn>2</mn><mi>H</mi></mtd></mtr><mtr><mtd></mtd><mtd><mi>s</mi><mi>t</mi><mi>r</mi><mi>e</mi><mi>a</mi><mi>m</mi><mn>1</mn><mo>:</mo><mstyle scriptlevel="0"><mspace width="2em"></mspace></mstyle><mstyle scriptlevel="0"><mspace width="2em"></mspace></mstyle><mi>H</mi><mn>2</mn><mi>D</mi><mo stretchy="false">→</mo><mi>K</mi><mi>E</mi><mi>R</mi><mo stretchy="false">→</mo><mi>D</mi><mn>2</mn><mi>H</mi></mtd></mtr><mtr><mtd></mtd><mtd><mi>s</mi><mi>t</mi><mi>r</mi><mi>e</mi><mi>a</mi><mi>m</mi><mn>2</mn><mo>:</mo><mstyle scriptlevel="0"><mspace width="2em"></mspace></mstyle><mstyle scriptlevel="0"><mspace width="2em"></mspace></mstyle><mstyle scriptlevel="0"><mspace width="2em"></mspace></mstyle><mstyle scriptlevel="0"><mspace width="2em"></mspace></mstyle><mi>H</mi><mn>2</mn><mi>D</mi><mo stretchy="false">→</mo><mi>K</mi><mi>E</mi><mi>R</mi><mo stretchy="false">→</mo><mi>D</mi><mn>2</mn><mi>H</mi></mtd></mtr></mtable></math></mjx-assistive-mml></mjx-container><p>性能提升<mjx-container class="MathJax" jax="SVG" style="direction:ltr;position:relative;"><svg style="overflow:visible;min-height:1px;min-width:1px;vertical-align:-0.816ex;" xmlns="http://www.w3.org/2000/svg" width="1.795ex" height="2.773ex" role="img" focusable="false" viewBox="0 -864.9 793.6 1225.5" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mfrac"><g data-mml-node="mn" transform="translate(220,394) scale(0.707)"><path data-c="39" d="M352 287Q304 211 232 211Q154 211 104 270T44 396Q42 412 42 436V444Q42 537 111 606Q171 666 243 666Q245 666 249 666T257 665H261Q273 665 286 663T323 651T370 619T413 560Q456 472 456 334Q456 194 396 97Q361 41 312 10T208 -22Q147 -22 108 7T68 93T121 149Q143 149 158 135T173 96Q173 78 164 65T148 49T135 44L131 43Q131 41 138 37T164 27T206 22H212Q272 22 313 86Q352 142 352 280V287ZM244 248Q292 248 321 297T351 430Q351 508 343 542Q341 552 337 562T323 588T293 615T246 625Q208 625 181 598Q160 576 154 546T147 441Q147 358 152 329T172 282Q197 248 244 248Z" style="stroke-width:3;"></path></g><g data-mml-node="mn" transform="translate(220,-345) scale(0.707)"><path data-c="35" d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z" style="stroke-width:3;"></path></g><rect width="553.6" height="60" x="120" y="220"></rect></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top:0px;left:0px;clip:rect(1px, 1px, 1px, 1px);-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;padding:1px 0px 0px 0px;border:0px;display:block;width:auto;overflow:hidden;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mn>9</mn><mn>5</mn></mfrac></math></mjx-assistive-mml></mjx-container>倍。<br> 事实上，分为<mjx-container class="MathJax" jax="SVG" style="direction:ltr;position:relative;"><svg style="overflow:visible;min-height:1px;min-width:1px;vertical-align:-0.025ex;" xmlns="http://www.w3.org/2000/svg" width="1.357ex" height="1.025ex" role="img" focusable="false" viewBox="0 -442 600 453" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z" style="stroke-width:3;"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top:0px;left:0px;clip:rect(1px, 1px, 1px, 1px);-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;padding:1px 0px 0px 0px;border:0px;display:block;width:auto;overflow:hidden;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></mjx-assistive-mml></mjx-container>份，理论上性能提升<mjx-container class="MathJax" jax="SVG" style="direction:ltr;position:relative;"><svg style="overflow:visible;min-height:1px;min-width:1px;vertical-align:-0.912ex;" xmlns="http://www.w3.org/2000/svg" width="4ex" height="2.867ex" role="img" focusable="false" viewBox="0 -864.2 1767.9 1267.2" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mfrac"><g data-mml-node="mrow" transform="translate(495.1,394) scale(0.707)"><g data-mml-node="mn"><path data-c="33" d="M127 463Q100 463 85 480T69 524Q69 579 117 622T233 665Q268 665 277 664Q351 652 390 611T430 522Q430 470 396 421T302 350L299 348Q299 347 308 345T337 336T375 315Q457 262 457 175Q457 96 395 37T238 -22Q158 -22 100 21T42 130Q42 158 60 175T105 193Q133 193 151 175T169 130Q169 119 166 110T159 94T148 82T136 74T126 70T118 67L114 66Q165 21 238 21Q293 21 321 74Q338 107 338 175V195Q338 290 274 322Q259 328 213 329L171 330L168 332Q166 335 166 348Q166 366 174 366Q202 366 232 371Q266 376 294 413T322 525V533Q322 590 287 612Q265 626 240 626Q208 626 181 615T143 592T132 580H135Q138 579 143 578T153 573T165 566T175 555T183 540T186 520Q186 498 172 481T127 463Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(500,0)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z" style="stroke-width:3;"></path></g></g><g data-mml-node="mrow" transform="translate(220,-345) scale(0.707)"><g data-mml-node="mi"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z" style="stroke-width:3;"></path></g><g data-mml-node="mo" transform="translate(600,0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z" style="stroke-width:3;"></path></g><g data-mml-node="mn" transform="translate(1378,0)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z" style="stroke-width:3;"></path></g></g><rect width="1527.9" height="60" x="120" y="220"></rect></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top:0px;left:0px;clip:rect(1px, 1px, 1px, 1px);-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;padding:1px 0px 0px 0px;border:0px;display:block;width:auto;overflow:hidden;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mn>3</mn><mi>n</mi></mrow><mrow><mi>n</mi><mo>+</mo><mn>2</mn></mrow></mfrac></math></mjx-assistive-mml></mjx-container>倍。但事实上，由于CUDA操作启动等额外开销，其加速比一般小于极限情况下的3。</p></div></div></main><footer class="VPDocFooter" data-v-a3c25e27 data-v-b4b63abf><!--[--><!--]--><!----><!----></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div><div class="site-footer"> MIT Licensed | Copyright © 2021-2022 <a class="vitepress" href="https://github.com/Silence020922">Silence&#39;s blog</a><br> Powered by <a class="vitepress" target="_blank" href="//vitepress.vuejs.org/">VitePress - 1.0.0-rc.25</a> Theme by <a class="vitepress" target="_blank" href="//github.com/airene/vitepress-blog-pure">Vitepress-blog</a></div><!--]--></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"pages_about.md\":\"zm3AryHG\",\"pages_archives.md\":\"Y4x88mh_\",\"posts_ascend.md\":\"gdcYjaqk\",\"posts_cmake.md\":\"qL8w_daa\",\"page_3.md\":\"IXVU8ZT_\",\"pages_tags.md\":\"_H06iygS\",\"page_2.md\":\"9xe-z58C\",\"posts_ascendc.md\":\"DAFu88XT\",\"index.md\":\"IAy2XZzz\",\"posts_vitepress-first.md\":\"a_Ol6IXs\",\"posts_transformer.md\":\"VJ7DBgZ_\",\"posts_vllm.md\":\"l3wB_VjQ\",\"posts_float.md\":\"wnh2o40O\",\"posts_theme-r.md\":\"hHO1s_cX\",\"posts_gnn-gcn.md\":\"RaQ93kzt\",\"posts_cuda.md\":\"Dith_Bog\",\"posts_gnn-agcn.md\":\"Vz13XZAC\",\"posts_gnn-recover.md\":\"-sIpv7Xt\",\"posts_gnn-introduction.md\":\"jRIVIQSk\",\"posts_gnn-acmp.md\":\"hd-s1wPg\",\"posts_gnn-rayleigh.md\":\"Bnj_EVuk\",\"posts_gnn-gcnii.md\":\"cOp8Foeh\",\"posts_gnn-chebyshev.md\":\"pZNoeOVL\",\"posts_flashattn.md\":\"GqPht6m4\",\"posts_pag.md\":\"lUg7yX_N\",\"posts_combinatorial_optimizition.md\":\"NUFb2FHH\",\"posts_gc-gceffects.md\":\"VbGvxQ5L\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"Silence's blog\",\"description\":\"Silence's blog\",\"base\":\"/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":\"dark\",\"themeConfig\":{\"posts\":[{\"frontMatter\":{\"date\":\"2024-04-18\",\"title\":\"GNN can recover the hidden features solely from the graph structure\",\"tags\":[\"GNN\"],\"description\":\"9-th, GNN能仅仅从图结构中恢复图内隐藏的特征信息，但现有的GNN框架还不能很好的完成特征恢复的任务...\"},\"regularPath\":\"/posts/GNN-Recover.html\"},{\"frontMatter\":{\"date\":\"2024-04-16\",\"title\":\"Ascend C 问题求助\",\"tags\":[\"Ascend C\"],\"description\":\"无\"},\"regularPath\":\"/posts/AscendC.html\"},{\"frontMatter\":{\"date\":\"2024-04-04\",\"title\":\"Ascend C开发流程\",\"tags\":[\"Ascend C\"],\"description\":\"无\"},\"regularPath\":\"/posts/Ascend.html\"},{\"frontMatter\":{\"date\":\"2024-03-20\",\"title\":\"A note\",\"tags\":[\"Float-FP16\"],\"description\":\"无...\"},\"regularPath\":\"/posts/Float.html\"},{\"frontMatter\":{\"date\":\"2024-03-01\",\"title\":\"CUDA编程\",\"tags\":[\"CUDA\"],\"description\":\"无...\"},\"regularPath\":\"/posts/CUDA.html\"},{\"frontMatter\":{\"date\":\"2024-02-27\",\"title\":\"Transformer\",\"tags\":[\"LLM\"],\"description\":\"参考论文 Attention is all you need\"},\"regularPath\":\"/posts/Transformer.html\"},{\"frontMatter\":{\"date\":\"2024-02-21\",\"title\":\"vLLM\",\"tags\":[\"LLM\"],\"description\":\"LLM增添内存管理，利用PagedAttention，提高服务器吞吐量。\"},\"regularPath\":\"/posts/vLLM.html\"},{\"frontMatter\":{\"date\":\"2024-02-21\",\"title\":\"FlashAttention\",\"tags\":[\"LLM\"],\"description\":\"加速transormer模型训练速度，以便应用到较长上下文中。\"},\"regularPath\":\"/posts/FlashAttn.html\"},{\"frontMatter\":{\"date\":\"2024-01-21\",\"title\":\"Preferential Attachment Graph\",\"tags\":[\"Random grpah\",\"Preferential Attachment Graph\"],\"description\":\"反应现实世界幂律分布现象的一种随机图的定义及性质。\"},\"regularPath\":\"/posts/PAG.html\"},{\"frontMatter\":{\"date\":\"2024-01-13\",\"title\":\"CMake\",\"tags\":[\"CMake\"],\"description\":\"CMake，缝缝补补也能用，最好还是了解了解\"},\"regularPath\":\"/posts/CMake.html\"},{\"frontMatter\":{\"date\":\"2024-01-08\",\"title\":\"Combinatorial Optimizition\",\"tags\":[\"Combinatorial Optimizition notes\"],\"description\":\"组合优化课程笔记\"},\"regularPath\":\"/posts/Combinatorial_Optimizition.html\"},{\"frontMatter\":{\"date\":\"2024-01-04\",\"title\":\"Effects of GC\",\"tags\":[\"GNN\"],\"description\":\"8-th，自GNN面世后，衍生了很多的变式，也存在很多实际的应用。但对向神经网络中添加卷积算子的意义本身，却缺乏理论上的证明，本文将携带卷积算子的神经网络与不使用图信息的神经网络进行对比，从理论出发给出严密的证明。参考Effects of graph convolutions in multi-layer networks\"},\"regularPath\":\"/posts/GC-GCEffects.html\"},{\"frontMatter\":{\"date\":\"2023-12-10\",\"title\":\"ACMP\",\"tags\":[\"GNN\"],\"description\":\"7-th，本文从神经信息传递的角度推到出模型并从能量函数的角度给出理论证明。参考Acmp:Allen-cahn message passing with attractive and repulsive forces for graph neural networks\"},\"regularPath\":\"/posts/GNN-ACMP.html\"},{\"frontMatter\":{\"date\":\"2023-12-09\",\"title\":\"GCNII\",\"tags\":[\"GNN\"],\"description\":\"6-th,参考SEMI-surperised classification with graph convolutional networks\"},\"regularPath\":\"/posts/GNN-GCNII.html\"},{\"frontMatter\":{\"date\":\"2023-12-05\",\"title\":\"AGCN\",\"tags\":[\"GNN\"],\"description\":\"5-th,考虑到在GCN模型中，由于表达与邻接矩阵直接相关，邻居节点的重要性由中心节点一圈一圈向外散布，这限制了卷积核的flexibility。这里考虑通过学习广义马氏距离替代邻接矩阵，实现对拉普拉斯矩阵的参数化设计，增加模型的表达能力。参考Adaptive Graph Convolutional Neural Networks。\"},\"regularPath\":\"/posts/GNN-AGCN.html\"},{\"frontMatter\":{\"date\":\"2023-12-04\",\"title\":\"GCN\",\"tags\":[\"GNN\"],\"description\":\"4-th,参考SEMI-surperised classification with graph convolutional networks\"},\"regularPath\":\"/posts/GNN-GCN.html\"},{\"frontMatter\":{\"date\":\"2023-12-03\",\"title\":\"Eigenvalues of the Laplacian\",\"tags\":[\"Rayleigh quotient\",\"Laplacian matrix\"],\"description\":\"3-rd,给出拉普拉斯矩阵特征值范围[0,2]的证明。\"},\"regularPath\":\"/posts/GNN-Rayleigh.html\"},{\"frontMatter\":{\"date\":\"2023-11-30\",\"title\":\"ChebNet\",\"tags\":[\"GNN\",\"Chebyshev\"],\"description\":\"2-nd,参考Convolution Neural Networks on Graphs with Fast Localized Spectral Filtering\"},\"regularPath\":\"/posts/GNN-Chebyshev.html\"},{\"frontMatter\":{\"date\":\"2023-11-29\",\"title\":\"Basic graph convolution operator\",\"tags\":[\"GNN\",\"GSP\"],\"description\":\"1-st，参考《深入浅出图神经网络》。\"},\"regularPath\":\"/posts/GNN-introduction.html\"},{\"frontMatter\":{\"title\":\"R语言入门\",\"date\":\"2022-10-17\",\"tags\":[\"R\"],\"description\":\"专业课——统计软件的随笔，这里使用的参考书目是《R语言实战(第二版)》\"},\"regularPath\":\"/posts/theme-R.html\"},{\"frontMatter\":{\"date\":\"2021-06-30\",\"title\":\"一直想找一个系统架构和设计都足够干净的系统\",\"tags\":[\"vitepress\",\"markdown\"],\"description\":\"vitepress的markdown插件支持的语法，一直想找一个干净的系统架构和设计都足够干净都，一直没满意的，不满意就自己设计，一直想找一个干净的系统架构和设计都足够干净都，一直没满意的，不满意就自己设计\"},\"regularPath\":\"/posts/vitepress-first.html\"}],\"website\":\"https://github.com/Silence020922\",\"nav\":[{\"text\":\"Home\",\"link\":\"/\"},{\"text\":\"Archives\",\"link\":\"/pages/archives\"},{\"text\":\"Tags\",\"link\":\"/pages/tags\"},{\"text\":\"About\",\"link\":\"/pages/about\"}],\"search\":{\"provider\":\"local\"},\"outlineTitle\":\"文章摘要\"},\"locales\":{},\"scrollOffset\":90,\"cleanUrls\":false}");</script>
    
  </body>
</html>